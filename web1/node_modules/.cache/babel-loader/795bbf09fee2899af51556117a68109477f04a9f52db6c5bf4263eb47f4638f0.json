{"ast":null,"code":"// src/pages/Section3Page.js\nimport React,{useState,useEffect}from'react';import{useNavigate,useLocation}from'react-router-dom';import{Container,Typography,Box,Paper,Button,Alert,AlertTitle,LinearProgress}from'@mui/material';import Section3Component from'../component/Section3Component';import{saveUserAnswers}from'../utils/firebaseUtils';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const steps=['암 이후 내 몸의 변화','건강한 삶을 위한 관리','회복하도록 도와주는 사람들','심리적 부담','사회적 삶의 부담','암 이후 탄력성','추가'];const Section3Page=()=>{const navigate=useNavigate();const{state}=useLocation();// SurveyForm 또는 로컬스토리지에서 사용자 이름 가져오기\nconst userName=(state===null||state===void 0?void 0:state.name)||localStorage.getItem('userName')||'';const[answers,setAnswers]=useState({q15_reasons:[]});const[error,setError]=useState(false);// Q14~Q17 진행\nconst requiredIds=['q14','q15','q16','q17'];const doneCount=requiredIds.filter(id=>answers[id]).length;const total=requiredIds.length;const progress=doneCount/total*100;const currentStep=2;// Q15-1 조건\nconst needsReasons=answers.q15==='1'||answers.q15==='2';const ready=needsReasons?doneCount===total&&answers.q15_reasons.length>0:doneCount===total;const handleNext=async()=>{if(!ready){setError(true);return;}try{await saveUserAnswers(userName,answers);// 답변 저장\nnavigate('/section4',{state:{name:userName,answers}});}catch(e){alert('답변 저장에 실패했습니다.');}};useEffect(()=>{if(ready)setError(false);},[ready]);return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{py:4,background:'none',bgcolor:'background.default'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",gutterBottom:true,sx:{fontWeight:'bold'},children:\"\\uC554 \\uC0DD\\uC874\\uC790 \\uAC74\\uAC15\\uAD00\\uB9AC \\uC124\\uBB38\"}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",align:\"center\",color:\"textSecondary\",gutterBottom:true,children:\"\\uC5EC\\uB7EC\\uBD84\\uC758 \\uAC74\\uAC15 \\uC0C1\\uD0DC\\uC640 \\uC77C\\uC0C1\\uC0DD\\uD65C\\uC5D0 \\uB300\\uD55C \\uAC83\\uC785\\uB2C8\\uB2E4. \\uC544\\uB798 \\uB0B4\\uC6A9\\uC744 \\uCCB4\\uD06C\\uD574 \\uC8FC\\uC138\\uC694.\"}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'space-between',mb:3},children:steps.map((label,idx)=>{const bg=idx<currentStep?'success.main':idx===currentStep?'primary.main':'grey.300';const color=idx<=currentStep?'text.primary':'text.disabled';return/*#__PURE__*/_jsxs(Box,{sx:{flex:1,textAlign:'center'},children:[/*#__PURE__*/_jsx(Box,{sx:{width:32,height:32,mx:'auto',borderRadius:'50%',bgcolor:bg,color:'#fff',display:'flex',alignItems:'center',justifyContent:'center'},children:idx+1}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{mt:1,color},children:label})]},label);})}),/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:'bold',mb:2,textAlign:'center'},children:steps[currentStep]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:progress}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",align:\"right\",sx:{mt:1,color:'text.secondary'},children:[\"\\uC9C4\\uD589 \\uC0C1\\uD669: \",doneCount,\"/\",total]})]}),/*#__PURE__*/_jsx(Section3Component,{name:userName,answers:answers,setAnswers:setAnswers}),error&&/*#__PURE__*/_jsxs(Alert,{severity:\"warning\",sx:{mt:2},children:[/*#__PURE__*/_jsx(AlertTitle,{children:\"\\uACBD\\uACE0\"}),\"\\uBAA8\\uB4E0 \\uBB38\\uD56D\\uC744 \\uC751\\uB2F5\\uD574\\uC57C \\uB2E4\\uC74C\\uC73C\\uB85C \\uB118\\uC5B4\\uAC08 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mt:4},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>navigate('/section2'),children:\"\\uC774\\uC804\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleNext,children:\"\\uB2E4\\uC74C\"})]})]})]});};export default Section3Page;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","useLocation","Container","Typography","Box","Paper","Button","Alert","AlertTitle","LinearProgress","Section3Component","saveUserAnswers","jsx","_jsx","jsxs","_jsxs","steps","Section3Page","navigate","state","userName","name","localStorage","getItem","answers","setAnswers","q15_reasons","error","setError","requiredIds","doneCount","filter","id","length","total","progress","currentStep","needsReasons","q15","ready","handleNext","e","alert","maxWidth","sx","py","background","bgcolor","children","variant","align","gutterBottom","fontWeight","color","display","justifyContent","mb","map","label","idx","bg","flex","textAlign","width","height","mx","borderRadius","alignItems","mt","elevation","p","value","severity","onClick"],"sources":["C:/Users/20201/OneDrive/바탕 화면/patient_survey/web1/src/page/Section3Page.js"],"sourcesContent":["// src/pages/Section3Page.js\nimport React, { useState, useEffect } from 'react';\nimport { useNavigate, useLocation } from 'react-router-dom';\nimport {\n  Container,\n  Typography,\n  Box,\n  Paper,\n  Button,\n  Alert,\n  AlertTitle,\n  LinearProgress\n} from '@mui/material';\nimport Section3Component from '../component/Section3Component';\nimport { saveUserAnswers } from '../utils/firebaseUtils';\n\nconst steps = [\n  '암 이후 내 몸의 변화',\n  '건강한 삶을 위한 관리',\n  '회복하도록 도와주는 사람들',\n  '심리적 부담',\n  '사회적 삶의 부담',\n  '암 이후 탄력성',\n  '추가'\n];\n\nconst Section3Page = () => {\n  const navigate = useNavigate();\n  const { state } = useLocation();\n  // SurveyForm 또는 로컬스토리지에서 사용자 이름 가져오기\n  const userName = state?.name || localStorage.getItem('userName') || '';\n\n  const [answers, setAnswers] = useState({ q15_reasons: [] });\n  const [error, setError] = useState(false);\n\n  // Q14~Q17 진행\n  const requiredIds = ['q14', 'q15', 'q16', 'q17'];\n  const doneCount = requiredIds.filter(id => answers[id]).length;\n  const total = requiredIds.length;\n  const progress = (doneCount / total) * 100;\n  const currentStep = 2;\n\n  // Q15-1 조건\n  const needsReasons = answers.q15 === '1' || answers.q15 === '2';\n  const ready = needsReasons\n    ? doneCount === total && answers.q15_reasons.length > 0\n    : doneCount === total;\n\n  const handleNext = async () => {\n    if (!ready) {\n      setError(true);\n      return;\n    }\n    try {\n      await saveUserAnswers(userName, answers); // 답변 저장\n      navigate('/section4', { state: { name: userName, answers } });\n    } catch (e) {\n      alert('답변 저장에 실패했습니다.');\n    }\n  };\n\n  useEffect(() => {\n    if (ready) setError(false);\n  }, [ready]);\n\n  return (\n    <Container\n      maxWidth=\"md\"\n      sx={{ py: 4, background: 'none', bgcolor: 'background.default' }}\n    >\n      <Typography\n        variant=\"h4\"\n        align=\"center\"\n        gutterBottom\n        sx={{ fontWeight: 'bold' }}\n      >\n        암 생존자 건강관리 설문\n      </Typography>\n      <Typography\n        variant=\"subtitle1\"\n        align=\"center\"\n        color=\"textSecondary\"\n        gutterBottom\n      >\n        여러분의 건강 상태와 일상생활에 대한 것입니다. 아래 내용을 체크해 주세요.\n      </Typography>\n\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 3 }}>\n        {steps.map((label, idx) => {\n          const bg =\n            idx < currentStep\n              ? 'success.main'\n              : idx === currentStep\n              ? 'primary.main'\n              : 'grey.300';\n          const color = idx <= currentStep ? 'text.primary' : 'text.disabled';\n          return (\n            <Box key={label} sx={{ flex: 1, textAlign: 'center' }}>\n              <Box\n                sx={{\n                  width: 32,\n                  height: 32,\n                  mx: 'auto',\n                  borderRadius: '50%',\n                  bgcolor: bg,\n                  color: '#fff',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n              >\n                {idx + 1}\n              </Box>\n              <Typography variant=\"caption\" sx={{ mt: 1, color }}>\n                {label}\n              </Typography>\n            </Box>\n          );\n        })}\n      </Box>\n\n      <Paper elevation={3} sx={{ p: 4 }}>\n        <Typography\n          variant=\"h6\"\n          sx={{ fontWeight: 'bold', mb: 2, textAlign: 'center' }}\n        >\n          {steps[currentStep]}\n        </Typography>\n\n        <Box sx={{ mb: 3 }}>\n          <LinearProgress variant=\"determinate\" value={progress} />\n          <Typography\n            variant=\"body2\"\n            align=\"right\"\n            sx={{ mt: 1, color: 'text.secondary' }}\n          >\n            진행 상황: {doneCount}/{total}\n          </Typography>\n        </Box>\n\n        <Section3Component name={userName}\n          answers={answers}\n          setAnswers={setAnswers}\n        />\n\n        {/* error가 true일 때만 Alert 보이기 */}\n        {error && (\n          <Alert severity=\"warning\" sx={{ mt: 2 }}>\n            <AlertTitle>경고</AlertTitle>\n            모든 문항을 응답해야 다음으로 넘어갈 수 있습니다.\n          </Alert>\n        )}\n\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 4 }}>\n          <Button variant=\"outlined\" onClick={() => navigate('/section2')}>\n            이전\n          </Button>\n          <Button variant=\"contained\" onClick={handleNext}>\n            다음\n          </Button>\n        </Box>\n      </Paper>\n    </Container>\n  );\n};\n\nexport default Section3Page;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}