{"ast":null,"code":"// src/pages/Section7Page.js\nimport React,{useState,useEffect}from'react';import{useLocation,useNavigate}from'react-router-dom';import{Container,Typography,Box,Paper,Button,Alert,AlertTitle,LinearProgress}from'@mui/material';import Section7Component from'../component/Section7Component';import{getUserAnswers}from'../utils/firebaseUtils';// Firestore에서 기존 답변 불러오기\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const steps=['암 이후 내 몸의 변화','건강한 삶을 위한 관리','회복하도록 도와주는 사람들','심리적 부담','사회적 삶의 부담','암 이후 탄력성','추가'];const Section7Page=()=>{const navigate=useNavigate();const{state}=useLocation();// SurveyForm 또는 로컬스토리지에서 사용자 이름 가져오기\nconst userName=(state===null||state===void 0?void 0:state.name)||localStorage.getItem('userName')||'';const[answers,setAnswers]=useState({});const[error,setError]=useState(false);// 마운트 시 기존 답변 불러오기\nuseEffect(()=>{if(!userName)return;getUserAnswers(userName).then(data=>{setAnswers(data||{});console.log('Loaded Section7 answers:',data);}).catch(err=>console.error('Error loading Section7 answers:',err));},[userName]);const total=2;// Q32~Q33\nconst done=['q32','q33'].filter(id=>answers[id]).length;const progress=done/total*100;const currentStep=6;const handleNext=()=>{if(done<total){setError(true);return;}// navigate 호출 시 answers를 state에 포함하여 전달\nnavigate('/survey-result',{state:{name:userName,answers:answers}});};useEffect(()=>{if(done===total)setError(false);},[done]);return/*#__PURE__*/_jsxs(Container,{maxWidth:\"md\",sx:{py:4,bgcolor:'background.default'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",align:\"center\",gutterBottom:true,sx:{fontWeight:'bold'},children:\"\\uC554 \\uC0DD\\uC874\\uC790 \\uAC74\\uAC15\\uAD00\\uB9AC \\uC124\\uBB38\"}),/*#__PURE__*/_jsx(Typography,{variant:\"subtitle1\",align:\"center\",color:\"textSecondary\",gutterBottom:true,children:\"\\uC5EC\\uB7EC\\uBD84\\uC758 \\uAC74\\uAC15 \\uC0C1\\uD0DC\\uC640 \\uC77C\\uC0C1\\uC0DD\\uD65C\\uC5D0 \\uB300\\uD55C \\uAC83\\uC785\\uB2C8\\uB2E4. \\uC544\\uB798 \\uB0B4\\uC6A9\\uC744 \\uCCB4\\uD06C\\uD574 \\uC8FC\\uC138\\uC694.\"}),/*#__PURE__*/_jsx(Box,{sx:{display:'flex',justifyContent:'space-between',mb:3},children:steps.map((label,idx)=>{const bg=idx<currentStep?'success.main':idx===currentStep?'primary.main':'grey.300';const color=idx<=currentStep?'text.primary':'text.disabled';return/*#__PURE__*/_jsxs(Box,{sx:{flex:1,textAlign:'center'},children:[/*#__PURE__*/_jsx(Box,{sx:{width:32,height:32,mx:'auto',borderRadius:'50%',bgcolor:bg,color:'#fff',display:'flex',alignItems:'center',justifyContent:'center'},children:idx+1}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",sx:{mt:1,color},children:label})]},label);})}),/*#__PURE__*/_jsxs(Paper,{elevation:3,sx:{p:4},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",sx:{fontWeight:'bold',mb:2,textAlign:'center'},children:steps[currentStep]}),/*#__PURE__*/_jsxs(Box,{sx:{mb:3},children:[/*#__PURE__*/_jsx(LinearProgress,{variant:\"determinate\",value:progress}),/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",align:\"right\",sx:{mt:1,color:'text.secondary'},children:[\"\\uC9C4\\uD589 \\uC0C1\\uD669: \",done,\"/\",total]})]}),/*#__PURE__*/_jsx(Section7Component,{name:userName,answers:answers,setAnswers:setAnswers}),error&&/*#__PURE__*/_jsxs(Alert,{severity:\"warning\",sx:{mt:2},children:[/*#__PURE__*/_jsx(AlertTitle,{children:\"\\uACBD\\uACE0\"}),\"\\uBAA8\\uB4E0 \\uBB38\\uD56D\\uC744 \\uC751\\uB2F5\\uD574\\uC57C \\uB2E4\\uC74C\\uC73C\\uB85C \\uB118\\uC5B4\\uAC08 \\uC218 \\uC788\\uC2B5\\uB2C8\\uB2E4.\"]}),/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',mt:4},children:[/*#__PURE__*/_jsx(Button,{variant:\"outlined\",onClick:()=>navigate('/section6',{state:{name:userName}}),children:\"\\uC774\\uC804\"}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",onClick:handleNext,children:\"\\uC644\\uB8CC\"})]})]})]});};export default Section7Page;","map":{"version":3,"names":["React","useState","useEffect","useLocation","useNavigate","Container","Typography","Box","Paper","Button","Alert","AlertTitle","LinearProgress","Section7Component","getUserAnswers","jsx","_jsx","jsxs","_jsxs","steps","Section7Page","navigate","state","userName","name","localStorage","getItem","answers","setAnswers","error","setError","then","data","console","log","catch","err","total","done","filter","id","length","progress","currentStep","handleNext","maxWidth","sx","py","bgcolor","children","variant","align","gutterBottom","fontWeight","color","display","justifyContent","mb","map","label","idx","bg","flex","textAlign","width","height","mx","borderRadius","alignItems","mt","elevation","p","value","severity","onClick"],"sources":["C:/Users/20201/OneDrive/바탕 화면/patient_survey/web1/src/page/Section7Page.js"],"sourcesContent":["// src/pages/Section7Page.js\nimport React, { useState, useEffect } from 'react';\nimport { useLocation, useNavigate } from 'react-router-dom';\nimport {\n  Container,\n  Typography,\n  Box,\n  Paper,\n  Button,\n  Alert,\n  AlertTitle,\n  LinearProgress\n} from '@mui/material';\nimport Section7Component from '../component/Section7Component';\nimport { getUserAnswers } from '../utils/firebaseUtils';  // Firestore에서 기존 답변 불러오기\n\nconst steps = [\n  '암 이후 내 몸의 변화',\n  '건강한 삶을 위한 관리',\n  '회복하도록 도와주는 사람들',\n  '심리적 부담',\n  '사회적 삶의 부담',\n  '암 이후 탄력성',\n  '추가'\n];\n\nconst Section7Page = () => {\n  const navigate = useNavigate();\n  const { state } = useLocation();\n  // SurveyForm 또는 로컬스토리지에서 사용자 이름 가져오기\n  const userName = state?.name || localStorage.getItem('userName') || '';\n\n  const [answers, setAnswers] = useState({});\n  const [error, setError] = useState(false);\n\n  // 마운트 시 기존 답변 불러오기\n  useEffect(() => {\n    if (!userName) return;\n    getUserAnswers(userName)\n      .then(data => {\n        setAnswers(data || {});\n        console.log('Loaded Section7 answers:', data);\n      })\n      .catch(err => console.error('Error loading Section7 answers:', err));\n  }, [userName]);\n\n  const total = 2;  // Q32~Q33\n  const done = ['q32','q33'].filter(id => answers[id]).length;\n  const progress = (done / total) * 100;\n  const currentStep = 6;\n\n  const handleNext = () => {\n    if (done < total) {\n      setError(true);\n      return;\n    }\n    // navigate 호출 시 answers를 state에 포함하여 전달\n    navigate('/survey-result', { state: { name: userName, answers: answers } });\n  };\n\n  useEffect(() => {\n    if (done === total) setError(false);\n  }, [done]);\n\n  return (\n    <Container maxWidth=\"md\" sx={{ py: 4, bgcolor: 'background.default' }}>\n      <Typography variant=\"h4\" align=\"center\" gutterBottom sx={{ fontWeight: 'bold' }}>\n        암 생존자 건강관리 설문\n      </Typography>\n      <Typography variant=\"subtitle1\" align=\"center\" color=\"textSecondary\" gutterBottom>\n        여러분의 건강 상태와 일상생활에 대한 것입니다. 아래 내용을 체크해 주세요.\n      </Typography>\n\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', mb: 3 }}>\n        {steps.map((label, idx) => {\n          const bg = idx < currentStep\n            ? 'success.main'\n            : idx === currentStep\n            ? 'primary.main'\n            : 'grey.300';\n          const color = idx <= currentStep ? 'text.primary' : 'text.disabled';\n          return (\n            <Box key={label} sx={{ flex: 1, textAlign: 'center' }}>\n              <Box\n                sx={{\n                  width: 32,\n                  height: 32,\n                  mx: 'auto',\n                  borderRadius: '50%',\n                  bgcolor: bg,\n                  color: '#fff',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center'\n                }}\n              >\n                {idx + 1}\n              </Box>\n              <Typography variant=\"caption\" sx={{ mt: 1, color }}>\n                {label}\n              </Typography>\n            </Box>\n          );\n        })}\n      </Box>\n\n      <Paper elevation={3} sx={{ p: 4 }}>\n        <Typography variant=\"h6\" sx={{ fontWeight: 'bold', mb: 2, textAlign: 'center' }}>\n          {steps[currentStep]}\n        </Typography>\n\n        <Box sx={{ mb: 3 }}>\n          <LinearProgress variant=\"determinate\" value={progress} />\n          <Typography variant=\"body2\" align=\"right\" sx={{ mt: 1, color: 'text.secondary' }}>\n            진행 상황: {done}/{total}\n          </Typography>\n        </Box>\n\n        <Section7Component\n          name={userName}\n          answers={answers}\n          setAnswers={setAnswers}\n        />\n\n        {error && (\n          <Alert severity=\"warning\" sx={{ mt: 2 }}>\n            <AlertTitle>경고</AlertTitle>\n            모든 문항을 응답해야 다음으로 넘어갈 수 있습니다.\n          </Alert>\n        )}\n\n        <Box sx={{ display: 'flex', justifyContent: 'space-between', mt: 4 }}>\n          <Button variant=\"outlined\" onClick={() => navigate('/section6', { state: { name: userName } })}>\n            이전\n          </Button>\n          <Button variant=\"contained\" onClick={handleNext}>\n            완료\n          </Button>\n        </Box>\n      </Paper>\n    </Container>\n  );\n};\n\nexport default Section7Page;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}