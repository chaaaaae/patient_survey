{"ast":null,"code":"// src/pages/PatientDetailPage.js\nimport React,{useState,useEffect}from'react';import{useParams,Link,useNavigate,useLocation}from'react-router-dom';import styled from'styled-components';import Layout from'../components/Layout';import{doc,getDoc,collection,query,where,getDocs,orderBy,addDoc,serverTimestamp,updateDoc,deleteDoc}from'firebase/firestore';import{db}from'../firebase';import{Bar,Radar}from'react-chartjs-2';import{Chart as ChartJS,CategoryScale,LinearScale,BarElement,RadialLinearScale,PointElement,LineElement,Filler,Tooltip,Legend}from'chart.js';// Chart.js ë“±ë¡\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";ChartJS.register(CategoryScale,LinearScale,BarElement,RadialLinearScale,PointElement,LineElement,Filler,Tooltip,Legend);// ì»¨í…Œì´ë„ˆ\nconst Container=styled.div`\n  margin-bottom: 2rem;\n`;// ë’¤ë¡œê°€ê¸° ë§í¬\nconst BackLink=styled(Link)`\n  display: inline-flex;\n  align-items: center;\n  font-size: 0.9rem;\n  color: #6c757d;\n  text-decoration: none;\n  margin-bottom: 1rem;\n  \n  &:hover {\n    color: #495057;\n  }\n`;// í™˜ì ì •ë³´ ë ˆì´ì•„ì›ƒ\nconst PatientInfo=styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 2rem;\n\n  .patient-details {\n    display: flex;\n    align-items: center;\n  }\n`;// í™˜ì ì´ë‹ˆì…œ ì•„ë°”íƒ€\nconst PatientAvatar=styled.div`\n  width: 60px;\n  height: 60px;\n  border-radius: 50%;\n  background-color: #2a5e8c;\n  color: white;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  font-weight: bold;\n  margin-right: 1rem;\n`;// í™˜ì ì´ë¦„ ë° ID\nconst PatientNameContainer=styled.div``;// í™˜ì ì´ë¦„\nconst PatientName=styled.h2`\n  font-size: 1.5rem;\n  margin: 0 0 0.5rem;\n`;// í™˜ì ID\nconst PatientId=styled.p`\n  color: #6c757d;\n  margin: 0;\n  font-size: 0.9rem;\n`;// ë²„íŠ¼\nconst Button=styled.button`\n  background-color: ${props=>props.secondary?'#6c757d':'#2a5e8c'};\n  color: white;\n  border: none;\n  border-radius: 4px;\n  padding: 0.5rem 1rem;\n  font-size: 0.9rem;\n  cursor: pointer;\n  \n  &:hover {\n    background-color: ${props=>props.secondary?'#5a6268':'#1d4269'};\n  }\n`;// íƒ­ ë„¤ë¹„ê²Œì´ì…˜\nconst TabNav=styled.div`\n  display: flex;\n  border-bottom: 1px solid #dee2e6;\n  margin-bottom: 2rem;\n`;// íƒ­ ë²„íŠ¼\nconst TabButton=styled.button`\n  padding: 0.75rem 1.5rem;\n  background: none;\n  border: none;\n  border-bottom: 2px solid ${props=>props.active?'#2a5e8c':'transparent'};\n  color: ${props=>props.active?'#2a5e8c':'#6c757d'};\n  font-weight: ${props=>props.active?'600':'400'};\n  cursor: pointer;\n  transition: all 0.2s ease-in-out;\n  \n  &:hover {\n    color: #2a5e8c;\n  }\n`;// ì¹´ë“œ\nconst Card=styled.div`\n  background-color: white;\n  border-radius: 8px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n`;// ì¹´ë“œ ì œëª©\nconst CardTitle=styled.h3`\n  font-size: 1.1rem;\n  margin: 0 0 1.5rem;\n  color: #343a40;\n  border-bottom: 1px solid #dee2e6;\n  padding-bottom: 0.75rem;\n`;// ì •ë³´ ê·¸ë¦¬ë“œ\nconst InfoGrid=styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n  gap: 1.5rem;\n`;// ì •ë³´ ê·¸ë£¹\nconst InfoGroup=styled.div`\n  margin-bottom: 1rem;\n`;// ì •ë³´ ë¼ë²¨\nconst InfoLabel=styled.p`\n  font-size: 0.8rem;\n  color: #6c757d;\n  margin: 0 0 0.25rem;\n`;// ì •ë³´ ê°’\nconst InfoValue=styled.p`\n  margin: 0;\n  font-weight: 500;\n`;// ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ\nconst ChartContainer=styled.div`\n  height: 300px;\n  margin-bottom: 2rem;\n`;// 2ì—´ ê·¸ë¦¬ë“œ\nconst TwoColumnGrid=styled.div`\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  gap: 1.5rem;\n  \n  @media (max-width: 992px) {\n    grid-template-columns: 1fr;\n  }\n`;// ìƒë‹´ ìš”ì²­ ëª©ë¡\nconst CounselingRequestsList=styled.div`\n  margin-top: 1.5rem;\n`;// ìƒë‹´ ìš”ì²­ ì•„ì´í…œ\nconst CounselingRequestItem=styled.div`\n  padding: 1rem 0;\n  border-bottom: 1px solid #dee2e6;\n  \n  &:last-child {\n    border-bottom: none;\n  }\n`;// ìƒë‹´ ìš”ì²­ í—¤ë”\nconst CounselingRequestHeader=styled.div`\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 0.5rem;\n`;// ìƒë‹´ ìš”ì²­ ì œëª©\nconst CounselingRequestTitle=styled.h4`\n  margin: 0;\n  font-size: 1rem;\n`;// ë°°ì§€\nconst Badge=styled.span`\n  display: inline-block;\n  padding: 0.25rem 0.5rem;\n  border-radius: 50px;\n  font-size: 0.75rem;\n  font-weight: 700;\n  background-color: ${props=>{if(props.status==='pending')return'#ffc107';if(props.status==='accepted')return'#28a745';if(props.status==='completed')return'#6c757d';if(props.type==='high')return'#dc3545';if(props.type==='medium')return'#ffc107';return'#28a745';}};\n  color: white;\n`;// ìƒë‹´ ìš”ì²­ ë©”íƒ€ ì •ë³´\nconst CounselingRequestMeta=styled.div`\n  display: flex;\n  justify-content: space-between;\n  color: #6c757d;\n  font-size: 0.8rem;\n`;// ìƒë‹´ ë…¸íŠ¸ ì…ë ¥ í¼\nconst NoteForm=styled.form`\n  margin-top: 2rem;\n`;// ì…ë ¥ í•„ë“œ\nconst TextArea=styled.textarea`\n  width: 100%;\n  padding: 0.75rem;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  resize: vertical;\n  min-height: 100px;\n  margin-bottom: 1rem;\n`;// ìƒë‹´ ë…¸íŠ¸ ëª©ë¡\nconst NotesList=styled.div`\n  margin-top: 1.5rem;\n`;// ìƒë‹´ ë…¸íŠ¸ ì•„ì´í…œ\nconst NoteItem=styled.div`\n  padding: 1rem;\n  border-bottom: 1px solid #dee2e6;\n  \n  &:last-child {\n    border-bottom: none;\n  }\n`;// ë…¸íŠ¸ í—¤ë”\nconst NoteHeader=styled.div`\n  display: flex;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n`;// ë…¸íŠ¸ ì •ë³´ ì˜ì—­\nconst NoteInfo=styled.div`\n  display: flex;\n  flex-direction: column;\n`;// ë…¸íŠ¸ ë‚ ì§œ\nconst NoteDate=styled.span`\n  color: #6c757d;\n  font-size: 0.8rem;\n`;// ë…¸íŠ¸ ì•¡ì…˜ ë²„íŠ¼ ì˜ì—­\nconst NoteActions=styled.div`\n  display: flex;\n  gap: 0.5rem;\n`;// ë…¸íŠ¸ ì•¡ì…˜ ë²„íŠ¼\nconst NoteActionButton=styled.button`\n  background: none;\n  border: none;\n  color: ${props=>props.delete?'#dc3545':'#2a5e8c'};\n  font-size: 0.85rem;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  \n  &:hover {\n    background-color: ${props=>props.delete?'#f8d7da':'#e6f2fa'};\n  }\n  \n  svg {\n    margin-right: 0.25rem;\n  }\n`;// ë…¸íŠ¸ ë‚´ìš©\nconst NoteContent=styled.p`\n  margin: 0;\n  white-space: pre-line;\n`;// ë…¸íŠ¸ ìˆ˜ì • ì…ë ¥ í•„ë“œ\nconst NoteEditTextArea=styled.textarea`\n  width: 100%;\n  padding: 0.75rem;\n  border: 1px solid #ced4da;\n  border-radius: 4px;\n  resize: vertical;\n  min-height: 100px;\n  margin-bottom: 1rem;\n`;// ë…¸íŠ¸ í¸ì§‘ ë²„íŠ¼ ê·¸ë£¹\nconst EditButtonGroup=styled.div`\n  display: flex;\n  gap: 0.5rem;\n  justify-content: flex-end;\n`;// ìŠ¤ì½”ì–´ì¹´ë“œ ì»¨í…Œì´ë„ˆ\nconst ScoreCardsContainer=styled.div`\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n  gap: 1rem;\n  margin-bottom: 1.5rem;\n`;// ìŠ¤ì½”ì–´ì¹´ë“œ\nconst ScoreCard=styled.div`\n  background-color: white;\n  border-radius: 8px;\n  padding: 1rem;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;// ìŠ¤ì½”ì–´ì¹´ë“œ ê°’\nconst ScoreValue=styled.div`\n  font-size: 1.8rem;\n  font-weight: 700;\n  color: ${props=>{if(props.score===null)return'#6c757d';if(props.score>=50)return'#28a745';if(props.score>=40)return'#ffc107';return'#dc3545';}};\n`;// ë¹ˆ ì ìˆ˜ í‘œì‹œë¥¼ ìœ„í•œ ìŠ¤íƒ€ì¼\nconst EmptyScore=styled.div`\n  font-size: 1.2rem;\n  color: #6c757d;\n  font-style: italic;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  \n  &::before {\n    content: \"â€”\";\n    font-size: 2rem;\n    font-style: normal;\n  }\n`;// ìŠ¤ì½”ì–´ì¹´ë“œ ë¼ë²¨\nconst ScoreLabel=styled.div`\n  font-size: 0.8rem;\n  color: #6c757d;\n  text-align: center;\n  margin-bottom: 0.5rem;\n`;// ë¹ˆ ìƒíƒœ ë©”ì‹œì§€\nconst EmptyState=styled.div`\n  text-align: center;\n  padding: 2rem;\n  color: #6c757d;\n`;// ì¹˜ë£Œ íƒœê·¸ ì»¨í…Œì´ë„ˆ\nconst TreatmentTagsContainer=styled.div`\n  display: flex;\n  flex-wrap: wrap;\n  gap: 0.5rem;\n  margin-top: 0.5rem;\n`;// ì¹˜ë£Œ íƒœê·¸\nconst TreatmentTag=styled.span`\n  background-color: #e9ecef;\n  color: #495057;\n  border-radius: 16px;\n  padding: 0.25rem 0.75rem;\n  font-size: 0.8rem;\n`;// íŠ¹ì´ì‚¬í•­ ì»¨í…Œì´ë„ˆ\nconst SpecialNoteContainer=styled.div`\n  background-color: #f8f9fa;\n  border-radius: 10px;\n  padding: 1.25rem;\n  box-shadow: 0 2px 4px rgba(0,0,0,0.05);\n  border-left: 4px solid #2a5e8c;\n`;// íŠ¹ì´ì‚¬í•­ ì œëª©\nconst SpecialNoteTitle=styled.h4`\n  font-size: 1rem;\n  color: #2a5e8c;\n  margin-top: 0;\n  margin-bottom: 1rem;\n  font-weight: 600;\n`;// íŠ¹ì´ì‚¬í•­ ëª©ë¡\nconst SpecialNoteList=styled.ul`\n  margin: 0;\n  padding-left: 1.25rem;\n  color: #495057;\n  \n  li {\n    margin-bottom: 0.5rem;\n  }\n`;// ì‘ë‹µ ì ìˆ˜ ë°°ì§€\nconst ScoreBadge=styled.div`\n  display: inline-block;\n  margin-top: 0.25rem;\n  font-size: 0.85rem;\n  padding: 0.15rem 0.5rem;\n  background-color: #e9ecef;\n  border-radius: 12px;\n  color: #2a5e8c;\n`;// í”¼ë“œë°± ì»¨í…Œì´ë„ˆ\nconst FeedbackContainer=styled.div`\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\n  border-radius: 12px;\n  padding: 1.5rem;\n  margin-bottom: 1.5rem;\n  border-left: 4px solid #2a5e8c;\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n`;// í”¼ë“œë°± ì œëª©\nconst FeedbackTitle=styled.h3`\n  color: #2a5e8c;\n  font-size: 1.2rem;\n  margin: 0 0 1.5rem 0;\n  display: flex;\n  align-items: center;\n  font-weight: 600;\n  \n  &::before {\n    content: \"ğŸ’¬\";\n    margin-right: 0.5rem;\n    font-size: 1.1rem;\n  }\n`;// í”¼ë“œë°± ì„¹ì…˜\nconst FeedbackSection=styled.div`\n  background: white;\n  border-radius: 8px;\n  padding: 1.25rem;\n  margin-bottom: 1rem;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);\n  border: 1px solid #e9ecef;\n  \n  &:last-child {\n    margin-bottom: 0;\n  }\n`;// í”¼ë“œë°± ì„¹ì…˜ ì œëª©\nconst FeedbackSectionTitle=styled.h4`\n  color: #495057;\n  font-size: 1rem;\n  margin: 0 0 0.75rem 0;\n  font-weight: 600;\n  display: flex;\n  align-items: center;\n  \n  &::before {\n    content: ${props=>props.type==='overall'?'\"ğŸ“Š\"':'\"ğŸ’¡\"'};\n    margin-right: 0.5rem;\n    font-size: 0.9rem;\n  }\n`;// í”¼ë“œë°± ë‚´ìš©\nconst FeedbackContent=styled.div`\n  color: #495057;\n  line-height: 1.6;\n  font-size: 0.95rem;\n  white-space: pre-line;\n  \n  p {\n    margin: 0 0 0.75rem 0;\n    \n    &:last-child {\n      margin-bottom: 0;\n    }\n  }\n`;// í”¼ë“œë°± ì—†ìŒ ìƒíƒœ\nconst NoFeedbackState=styled.div`\n  text-align: center;\n  padding: 2rem;\n  color: #6c757d;\n  background: white;\n  border-radius: 8px;\n  border: 2px dashed #dee2e6;\n  \n  &::before {\n    content: \"ğŸ“\";\n    display: block;\n    font-size: 2rem;\n    margin-bottom: 0.5rem;\n  }\n`;// ìƒë‹´ ìš”ì²­ ìƒíƒœë¥¼ í•œê¸€ë¡œ ë³€í™˜\nconst getRequestStatusText=status=>{const statuses={'pending':'ëŒ€ê¸° ì¤‘','accepted':'ì˜ˆì•½ í™•ì •','completed':'ì™„ë£Œ','cancelled':'ì·¨ì†Œë¨'};return statuses[status]||'ì•Œ ìˆ˜ ì—†ìŒ';};// ì˜ì—­ë³„ í‰ê·  ë° í‘œì¤€í¸ì°¨ ì •ë³´ (ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ ê¸°ì¡´ ì½”ë“œì™€ì˜ í˜¸í™˜ì„±ì„ ìœ„í•´ ìœ ì§€)\nconst domainStats={physical:{mean:3.09,sd:0.95},selfcare:{mean:3.63,sd:0.76},support:{mean:3.84,sd:0.94},psychological:{mean:3.08,sd:0.91},social:{mean:3.39,sd:1.20},resilience:{mean:4.28,sd:0.72}};function PatientDetailPage(){const{patientId}=useParams();const navigate=useNavigate();const location=useLocation();const[patient,setPatient]=useState(null);const[counselingRequests,setCounselingRequests]=useState([]);const[notes,setNotes]=useState([]);const[newNote,setNewNote]=useState('');const[editNoteId,setEditNoteId]=useState(null);// í˜„ì¬ ìˆ˜ì • ì¤‘ì¸ ë…¸íŠ¸ ID\nconst[editNoteContent,setEditNoteContent]=useState('');// ìˆ˜ì • ì¤‘ì¸ ë…¸íŠ¸ ë‚´ìš©\nconst[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[surveyData,setSurveyData]=useState(null);const[categoryScores,setCategoryScores]=useState({physicalChange:{title:'ì‹ ì²´ì  ë³€í™”',score:0},healthManagement:{title:'ê±´ê°• ê´€ë¦¬',score:0},socialSupport:{title:'ì‚¬íšŒì  ì§€ì§€',score:0},psychologicalBurden:{title:'ì‹¬ë¦¬ì  ë¶€ë‹´',score:0},socialBurden:{title:'ì‚¬íšŒì  ë¶€ë‹´',score:0},resilience:{title:'íšŒë³µ íƒ„ë ¥ì„±',score:0}});// URLì—ì„œ íƒ­ íŒŒë¼ë¯¸í„°ë¥¼ ì½ì–´ì™€ì„œ ì´ˆê¸° íƒ­ ì„¤ì •\nconst[activeTab,setActiveTab]=useState('overview');useEffect(()=>{// URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì—ì„œ tab ê°’ì„ ì½ì–´ì˜´\nconst queryParams=new URLSearchParams(location.search);const tabParam=queryParams.get('tab');// tab íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ í•´ë‹¹ íƒ­ì„ í™œì„±í™”\nif(tabParam&&['overview','survey','counseling'].includes(tabParam)){setActiveTab(tabParam);}},[location]);// í™˜ì ë°ì´í„° ë° ê´€ë ¨ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°\nuseEffect(()=>{const fetchPatientData=async()=>{try{// í™˜ì ê¸°ë³¸ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° - users ì»¬ë ‰ì…˜ì—ì„œ ê°€ì ¸ì˜¤ê¸°\nconst patientDocRef=doc(db,\"users\",patientId);const patientDocSnap=await getDoc(patientDocRef);if(!patientDocSnap.exists()){setError('í™˜ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');setLoading(false);return;}const userData=patientDocSnap.data();// ìœ„í—˜ë„ ê²°ì • - ì„¤ë¬¸ì¡°ì‚¬ ì „ì²´ ì´ì  newScore ê¸°ë°˜\nlet riskLevel='low';// ê¸°ë³¸ê°’ì€ ì–‘í˜¸\n// ì„¤ë¬¸ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ newScore ê¸°ë°˜ ìœ„í—˜ë„ ê³„ì‚°\nif(userData.surveyResults&&userData.surveyResults.length>0&&userData.surveyResults[0].stdScores){const stdScores=userData.surveyResults[0].stdScores;// ëª¨ë“  ìœ íš¨í•œ ì ìˆ˜ë“¤ì˜ í‰ê·  ê³„ì‚°\nconst validScores=[];Object.values(stdScores).forEach(score=>{if(typeof score==='number'&&!isNaN(score)){validScores.push(score);}});if(validScores.length>0){const averageScore=validScores.reduce((sum,score)=>sum+score,0)/validScores.length;// í‰ê·  ì ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ìœ„í—˜ë„ ê²°ì •\nif(averageScore<40){riskLevel='high';// 40ì  ë¯¸ë§Œì€ ìœ„í—˜\n}else if(averageScore<50){riskLevel='medium';// 40~49ì ì€ ì£¼ì˜\n}else{riskLevel='low';// 50ì  ì´ìƒì€ ì–‘í˜¸\n}}}else{// ì„¤ë¬¸ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ ëŒ€ì²´\nif(userData.mentalHealthHistory&&userData.mentalHealthHistory!==\"ì•„ë‹ˆì˜¤\"){riskLevel='high';}else if(userData.mentalHealthImpact){riskLevel='medium';}}// ì„¤ë¬¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° - answers í•„ë“œì—ì„œ ê°€ì ¸ì˜¤ê¸°\nconst answers=userData.answers||{};// q32(ì ˆì£¼), q33(ê¸ˆì—°) ë°ì´í„° í™•ì¸\nlet alcoholAbstinence='ì •ë³´ ì—†ìŒ';let smokingCessation='ì •ë³´ ì—†ìŒ';if(answers.q32){const q32Score=parseInt(answers.q32);// ì ìˆ˜ê°€ 3ì  ì´ìƒì´ë©´ \"ì˜ˆ\", ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ \"ì•„ë‹ˆì˜¤\"\nalcoholAbstinence=q32Score>=3?'ì˜ˆ':'ì•„ë‹ˆì˜¤';}if(answers.q33){const q33Score=parseInt(answers.q33);// ì ìˆ˜ê°€ 3ì  ì´ìƒì´ë©´ \"ì˜ˆ\", ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ \"ì•„ë‹ˆì˜¤\"\nsmokingCessation=q33Score>=3?'ì˜ˆ':'ì•„ë‹ˆì˜¤';}// ì •ì‹ ê±´ê°• ì§„ë‹¨ëª…ë“¤ì„ ë¬¸ìì—´ë¡œ ë³€í™˜\nlet mentalHealthDiagnosesText='ì—†ìŒ';if(userData.mentalHealthDiagnoses){const diagnoses=[];if(userData.mentalHealthDiagnoses.depression)diagnoses.push('ìš°ìš¸ì¦');if(userData.mentalHealthDiagnoses.anxietyDisorder)diagnoses.push('ë¶ˆì•ˆì¥ì• ');if(userData.mentalHealthDiagnoses.schizophrenia)diagnoses.push('ì¡°í˜„ë³‘');if(userData.mentalHealthDiagnoses.other)diagnoses.push('ê¸°íƒ€');if(diagnoses.length>0){mentalHealthDiagnosesText=diagnoses.join(', ');}}// ìƒë…„ì›”ì¼ë¡œë¶€í„° ë‚˜ì´ ê³„ì‚°\nconst calculateAge=birthDate=>{if(!birthDate)return null;const today=new Date();const birth=new Date(birthDate);if(isNaN(birth.getTime()))return null;let age=today.getFullYear()-birth.getFullYear();const monthDiff=today.getMonth()-birth.getMonth();if(monthDiff<0||monthDiff===0&&today.getDate()<birth.getDate()){age--;}return age;};const calculatedAge=calculateAge(userData.birthDate);const patientData={id:patientDocSnap.id,name:userData.name||'ìµëª…',gender:userData.gender||'',birthDate:userData.birthDate||'',age:calculatedAge,maritalStatus:userData.maritalStatus||'',cancerType:userData.cancerType||'',cancerStage:userData.cancerStage||'',diagnosisDate:userData.diagnosisDate||'',hasRecurrence:userData.hasRecurrence||'',hasSurgery:userData.hasSurgery||'',surgeryDate:userData.surgeryDate||'',otherCancerDiagnosis:userData.otherCancerDiagnosis||'',otherCancerType:userData.otherCancerType||'',otherCancerDetails:userData.otherCancerDetails||'',mentalHealthHistory:userData.mentalHealthHistory||'',mentalHealthDiagnoses:mentalHealthDiagnosesText,otherMentalDiagnosis:userData.otherMentalDiagnosis||'',mentalHealthImpact:userData.mentalHealthImpact||'',otherTreatmentType:userData.otherTreatmentType||'',alcoholAbstinence:alcoholAbstinence,// ì ˆì£¼ ì—¬ë¶€ ì¶”ê°€\nsmokingCessation:smokingCessation,// ê¸ˆì—° ì—¬ë¶€ ì¶”ê°€\nriskLevel};setPatient(patientData);if(userData.surveyResults&&userData.surveyResults.length>0&&userData.surveyResults[0].stdScores){setSurveyData(userData.answers||{});const stdScores=userData.surveyResults[0].stdScores;// ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜ ì„¤ì • (ë””ë¹„ì—ì„œ ì§ì ‘ ê°€ì ¸ì˜¨ ì ìˆ˜ ì‚¬ìš©)\nconst updatedCategoryScores={physicalChange:{title:'ì‹ ì²´ì  ë³€í™”',score:typeof stdScores.physicalChange==='number'?stdScores.physicalChange:null},healthManagement:{title:'ê±´ê°• ê´€ë¦¬',score:typeof stdScores.healthManagement==='number'?stdScores.healthManagement:null},socialSupport:{title:'ì‚¬íšŒì  ì§€ì§€',score:typeof stdScores.socialSupport==='number'?stdScores.socialSupport:null},psychologicalBurden:{title:'ì‹¬ë¦¬ì  ë¶€ë‹´',score:typeof stdScores.psychologicalBurden==='number'?stdScores.psychologicalBurden:null},socialBurden:{title:'ì‚¬íšŒì  ë¶€ë‹´',score:typeof stdScores.socialBurden==='number'?stdScores.socialBurden:null},resilience:{title:'íšŒë³µ íƒ„ë ¥ì„±',score:typeof stdScores.resilience==='number'?stdScores.resilience:null}};setCategoryScores(updatedCategoryScores);}// ìƒë‹´ ìš”ì²­ ë¶ˆëŸ¬ì˜¤ê¸°\nconst counselingRequestsRef=collection(db,\"counselingRequests\");const q=query(counselingRequestsRef,where(\"userId\",\"==\",patientId));const counselingSnap=await getDocs(q);const requestsData=[];counselingSnap.forEach(doc=>{var _doc$data$createdAt;requestsData.push({id:doc.id,...doc.data(),createdAt:((_doc$data$createdAt=doc.data().createdAt)===null||_doc$data$createdAt===void 0?void 0:_doc$data$createdAt.toDate())||new Date()});});setCounselingRequests(requestsData);// ìƒë‹´ ë…¸íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°\nconst notesRef=collection(db,\"patients\",patientId,\"notes\");let notesQuery=notesRef;try{notesQuery=query(notesRef,orderBy(\"createdAt\",\"desc\"));}catch(e){console.error(\"Error creating notes query with orderBy:\",e);}const notesSnap=await getDocs(notesQuery);const notesData=[];notesSnap.forEach(doc=>{var _doc$data$createdAt2;notesData.push({id:doc.id,...doc.data(),createdAt:((_doc$data$createdAt2=doc.data().createdAt)===null||_doc$data$createdAt2===void 0?void 0:_doc$data$createdAt2.toDate())||new Date()});});setNotes(notesData);setLoading(false);}catch(error){setError('í™˜ì ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');setLoading(false);}};if(patientId){fetchPatientData();}},[patientId]);// ìƒë‹´ ë…¸íŠ¸ ì¶”ê°€\nconst handleAddNote=async e=>{e.preventDefault();if(!newNote.trim())return;try{const noteData={content:newNote,authorId:'ê´€ë¦¬ì',// ê°„ì†Œí™”ëœ ê¸°ë³¸ ì €ì ID\ncreatedAt:serverTimestamp()};const noteDocRef=await addDoc(collection(db,\"patients\",patientId,\"notes\"),noteData);const newNoteWithId={id:noteDocRef.id,...noteData,createdAt:new Date()};setNotes([newNoteWithId,...notes]);setNewNote('');}catch(error){alert('ìƒë‹´ ë…¸íŠ¸ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ìˆ˜ì • ëª¨ë“œ ì§„ì…\nconst handleEditMode=note=>{setEditNoteId(note.id);setEditNoteContent(note.content);};// ìˆ˜ì • ì·¨ì†Œ\nconst handleCancelEdit=()=>{setEditNoteId(null);setEditNoteContent('');};// ë…¸íŠ¸ ìˆ˜ì • ì €ì¥\nconst handleUpdateNote=async noteId=>{if(!editNoteContent.trim())return;try{// Firestore ë¬¸ì„œ ì—…ë°ì´íŠ¸\nconst noteRef=doc(db,\"patients\",patientId,\"notes\",noteId);await updateDoc(noteRef,{content:editNoteContent,updatedAt:serverTimestamp()});// ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\nconst updatedNotes=notes.map(note=>{if(note.id===noteId){return{...note,content:editNoteContent,updatedAt:new Date()};}return note;});setNotes(updatedNotes);setEditNoteId(null);setEditNoteContent('');}catch(error){alert('ìƒë‹´ ë…¸íŠ¸ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ë…¸íŠ¸ ì‚­ì œ\nconst handleDeleteNote=async noteId=>{if(!window.confirm('ì´ ìƒë‹´ ë…¸íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')){return;}try{// Firestore ë¬¸ì„œ ì‚­ì œ\nconst noteRef=doc(db,\"patients\",patientId,\"notes\",noteId);await deleteDoc(noteRef);// ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\nconst filteredNotes=notes.filter(note=>note.id!==noteId);setNotes(filteredNotes);}catch(error){alert('ìƒë‹´ ë…¸íŠ¸ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');}};// ìƒë‹´ ìš”ì²­ ì²˜ë¦¬ í˜ì´ì§€ë¡œ ì´ë™\nconst handleProcessRequest=requestId=>{navigate(`/counseling-record/${requestId}`);};// í™˜ì ì´ë‹ˆì…œ ê°€ì ¸ì˜¤ê¸°\nconst getPatientInitials=()=>{if(!patient||!patient.name)return'?';const nameParts=patient.name.split(' ');if(nameParts.length>1){return`${nameParts[0][0]}${nameParts[1][0]}`.toUpperCase();}return patient.name[0].toUpperCase();};// ë ˆì´ë” ì°¨íŠ¸ ë°ì´í„°\nconst radarChartData={labels:Object.values(categoryScores).map(cat=>cat.title),datasets:[{label:'ì·¨ë“ ì ìˆ˜',data:Object.values(categoryScores).map(cat=>cat.score!==null?cat.score:0),backgroundColor:'rgba(42, 94, 140, 0.2)',borderColor:'rgba(42, 94, 140, 1)',borderWidth:2,pointBackgroundColor:'rgba(42, 94, 140, 1)'}]};// ë ˆì´ë” ì°¨íŠ¸ ì˜µì…˜\nconst radarChartOptions={scales:{r:{angleLines:{display:true},min:0,max:100,ticks:{stepSize:20}}},maintainAspectRatio:false};// ë°” ì°¨íŠ¸ ë°ì´í„°\nconst barChartData={labels:Object.values(categoryScores).map(cat=>cat.title),datasets:[{label:'ì·¨ë“ ì ìˆ˜',data:Object.values(categoryScores).map(cat=>cat.score!==null?cat.score:0),backgroundColor:'rgba(42, 94, 140, 0.7)'},{label:'í‰ê·  ì ìˆ˜',data:[41,54,60,40,48,71],// ê¸°ì¤€ í‰ê· ê°’\nbackgroundColor:'rgba(220, 220, 220, 0.7)'}]};// ë°” ì°¨íŠ¸ ì˜µì…˜\nconst barChartOptions={responsive:true,scales:{y:{beginAtZero:true}},maintainAspectRatio:false};// 13-1 ì„¤ë¬¸ ì§ˆë¬¸ ëª©ë¡\nconst surveyQuestions={// ì‹ì´ì¡°ì ˆ ì„¸ë¶€ í•­ëª©\nq13_1_1:\"ì¡°ë¯¸ë£Œ ì„­ì·¨ë¥¼ ì¤„ì¸ë‹¤.\",q13_1_2:\"ì‹í’ˆì˜ ì‹ ì„ ë„ë¥¼ ì¤‘ìš”ì‹œí•œë‹¤.\",q13_1_3:\"ì±„ì‹ ë° ê³¼ì¼ ìœ„ì£¼ì˜ ì‹ìŠµê´€ì„ í•œë‹¤.\",q13_1_4:\"ìœ¡ë¥˜ ì„­ì·¨ë¥¼ ì¡°ì ˆí•œë‹¤.\",q13_1_5:\"íƒ„ìˆ˜í™”ë¬¼ ì„­ì·¨ë¥¼ ì¡°ì ˆí•œë‹¤.\",q13_1_6:\"í•­ì•”ì‹í’ˆ(ì˜ˆ: ë²„ì„¯, ë„ë¼ì§€, ë‘ìœ , í˜„ë¯¸ì‹ ë“±)ì„ ë¨¹ëŠ”ë‹¤.\"};// ì„¤ë¬¸ ì‘ë‹µì— ëŒ€í•œ ì„¤ëª…\nconst getScoreDescription=score=>{const scoreInt=parseInt(score);switch(scoreInt){case 1:return\"ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤\";case 2:return\"ê·¸ë ‡ì§€ ì•Šë‹¤\";case 3:return\"ë³´í†µì´ë‹¤\";case 4:return\"ê·¸ë ‡ë‹¤\";case 5:return\"ë§¤ìš° ê·¸ë ‡ë‹¤\";default:return\"ì‘ë‹µ ì—†ìŒ\";}};// NewScore í‰ê°€\nconst getScoreLevel=score=>{if(score===null)return\"ëŒ€ìƒì™¸\";if(score>=50)return\"ì–‘í˜¸\";if(score>=40)return\"ë³´í†µ\";return\"ì£¼ì˜\";};if(loading){return/*#__PURE__*/_jsx(Layout,{title:\"\\uD658\\uC790 \\uC0C1\\uC138 \\uC815\\uBCF4\",children:/*#__PURE__*/_jsx(Container,{children:/*#__PURE__*/_jsx(\"p\",{children:\"\\uD658\\uC790 \\uB370\\uC774\\uD130\\uB97C \\uBD88\\uB7EC\\uC624\\uB294 \\uC911...\"})})});}if(error){return/*#__PURE__*/_jsx(Layout,{title:\"\\uD658\\uC790 \\uC0C1\\uC138 \\uC815\\uBCF4\",children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(BackLink,{to:\"/\",children:\"\\u2190 \\uB300\\uC2DC\\uBCF4\\uB4DC\\uB85C \\uB3CC\\uC544\\uAC00\\uAE30\"}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uC624\\uB958\"}),/*#__PURE__*/_jsx(\"p\",{children:error})]})]})});}if(!patient){return/*#__PURE__*/_jsx(Layout,{title:\"\\uD658\\uC790 \\uC0C1\\uC138 \\uC815\\uBCF4\",children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(BackLink,{to:\"/\",children:\"\\u2190 \\uB300\\uC2DC\\uBCF4\\uB4DC\\uB85C \\uB3CC\\uC544\\uAC00\\uAE30\"}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uD658\\uC790\\uB97C \\uCC3E\\uC744 \\uC218 \\uC5C6\\uC74C\"}),/*#__PURE__*/_jsx(\"p\",{children:\"\\uD574\\uB2F9 ID\\uC758 \\uD658\\uC790\\uB97C \\uCC3E\\uC744 \\uC218 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"})]})]})});}return/*#__PURE__*/_jsx(Layout,{title:\"\\uD658\\uC790 \\uC0C1\\uC138 \\uC815\\uBCF4\",children:/*#__PURE__*/_jsxs(Container,{children:[/*#__PURE__*/_jsx(BackLink,{to:\"/\",children:\"\\u2190 \\uB300\\uC2DC\\uBCF4\\uB4DC\\uB85C \\uB3CC\\uC544\\uAC00\\uAE30\"}),/*#__PURE__*/_jsx(PatientInfo,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"patient-details\",children:[/*#__PURE__*/_jsx(PatientAvatar,{children:getPatientInitials()}),/*#__PURE__*/_jsxs(PatientNameContainer,{children:[/*#__PURE__*/_jsx(PatientName,{children:patient.name||'ìµëª… í™˜ì'}),/*#__PURE__*/_jsxs(PatientId,{children:[\"ID: \",patient.id]})]})]})}),/*#__PURE__*/_jsxs(TabNav,{children:[/*#__PURE__*/_jsx(TabButton,{active:activeTab==='overview',onClick:()=>setActiveTab('overview'),children:\"\\uAE30\\uBCF8 \\uC815\\uBCF4\"}),/*#__PURE__*/_jsx(TabButton,{active:activeTab==='survey',onClick:()=>setActiveTab('survey'),children:\"\\uAC74\\uAC15 \\uC0C1\\uD0DC\"}),/*#__PURE__*/_jsx(TabButton,{active:activeTab==='counseling',onClick:()=>setActiveTab('counseling'),children:\"\\uC0C1\\uB2F4 \\uAE30\\uB85D\"})]}),activeTab==='overview'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uD658\\uC790 \\uAE30\\uBCF8 \\uC815\\uBCF4\"}),/*#__PURE__*/_jsxs(InfoGrid,{children:[/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC774\\uB984\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.name||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC131\\uBCC4\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.gender||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC0DD\\uB144\\uC6D4\\uC77C\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.birthDate||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uB098\\uC774\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.age!==null?`${patient.age}ì„¸`:'ê³„ì‚° ë¶ˆê°€'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uACB0\\uD63C \\uC0C1\\uD0DC\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.maritalStatus||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC554 \\uC885\\uB958\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.cancerType||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC554 \\uBCD1\\uAE30\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.cancerStage||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC9C4\\uB2E8\\uC77C\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.diagnosisDate||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC7AC\\uBC1C \\uC5EC\\uBD80\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.hasRecurrence||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC218\\uC220 \\uC5EC\\uBD80\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.hasSurgery||'ì •ë³´ ì—†ìŒ'})]}),patient.surgeryDate&&/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC218\\uC220\\uC77C\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.surgeryDate})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uB2E4\\uB978 \\uC554 \\uC9C4\\uB2E8 \\uC5EC\\uBD80\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.otherCancerDiagnosis||'ì •ë³´ ì—†ìŒ'})]}),patient.otherCancerType&&/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uB2E4\\uB978 \\uC554 \\uC885\\uB958\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.otherCancerType})]}),patient.otherCancerDetails&&/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uB2E4\\uB978 \\uC554 \\uC0C1\\uC138 \\uC815\\uBCF4\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.otherCancerDetails})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC815\\uC2E0 \\uAC74\\uAC15\\uB825\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.mentalHealthHistory||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC815\\uC2E0\\uAC74\\uAC15 \\uC9C4\\uB2E8\\uBA85\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.mentalHealthDiagnoses||'ì—†ìŒ'})]}),patient.otherMentalDiagnosis&&/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uAE30\\uD0C0 \\uC815\\uC2E0\\uAC74\\uAC15 \\uC9C4\\uB2E8\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.otherMentalDiagnosis})]}),patient.mentalHealthImpact&&/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC815\\uC2E0\\uAC74\\uAC15 \\uC601\\uD5A5\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.mentalHealthImpact})]}),patient.otherTreatmentType&&/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uAE30\\uD0C0 \\uCE58\\uB8CC\\uBC95\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.otherTreatmentType})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC808\\uC8FC \\uC5EC\\uBD80\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.alcoholAbstinence||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uAE08\\uC5F0 \\uC5EC\\uBD80\"}),/*#__PURE__*/_jsx(InfoValue,{children:patient.smokingCessation||'ì •ë³´ ì—†ìŒ'})]}),/*#__PURE__*/_jsxs(InfoGroup,{children:[/*#__PURE__*/_jsx(InfoLabel,{children:\"\\uC704\\uD5D8\\uB3C4\"}),/*#__PURE__*/_jsx(Badge,{type:patient.riskLevel,children:patient.riskLevel==='high'?'ìœ„í—˜':patient.riskLevel==='medium'?'ì£¼ì˜':'ì–‘í˜¸'})]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uCD5C\\uADFC \\uC0C1\\uB2F4 \\uC694\\uCCAD\"}),counselingRequests.length===0?/*#__PURE__*/_jsx(EmptyState,{children:\"\\uC544\\uC9C1 \\uC0C1\\uB2F4 \\uC694\\uCCAD\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}):/*#__PURE__*/_jsx(CounselingRequestsList,{children:counselingRequests.slice(0,3).map(request=>/*#__PURE__*/_jsxs(CounselingRequestItem,{children:[/*#__PURE__*/_jsxs(CounselingRequestHeader,{children:[/*#__PURE__*/_jsxs(CounselingRequestTitle,{children:[\"\\uC0C1\\uB2F4 \\uC694\\uCCAD #\",request.id.substring(0,8)]}),/*#__PURE__*/_jsx(Badge,{status:request.status,children:getRequestStatusText(request.status)})]}),/*#__PURE__*/_jsx(\"p\",{children:request.concerns}),/*#__PURE__*/_jsxs(CounselingRequestMeta,{children:[/*#__PURE__*/_jsxs(\"span\",{children:[\"\\uC694\\uCCAD\\uC77C: \",request.createdAt.toLocaleDateString()]}),/*#__PURE__*/_jsx(Button,{onClick:()=>handleProcessRequest(request.id),children:\"\\uC0C1\\uC138\\uBCF4\\uAE30\"})]})]},request.id))})]})]}),activeTab==='survey'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uAC74\\uAC15 \\uC0C1\\uD0DC \\uD3C9\\uAC00\"}),/*#__PURE__*/_jsx(ScoreCardsContainer,{children:Object.entries(categoryScores).map(_ref=>{let[key,data]=_ref;return/*#__PURE__*/_jsxs(ScoreCard,{children:[/*#__PURE__*/_jsx(ScoreLabel,{children:data.title}),data.score!==null?/*#__PURE__*/_jsx(ScoreValue,{score:data.score,children:data.score}):/*#__PURE__*/_jsx(EmptyScore,{}),/*#__PURE__*/_jsx(InfoLabel,{children:getScoreLevel(data.score)})]},key);})}),/*#__PURE__*/_jsxs(TwoColumnGrid,{children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uC601\\uC5ED\\uBCC4 \\uBE44\\uAD50\"}),/*#__PURE__*/_jsx(ChartContainer,{children:/*#__PURE__*/_jsx(Radar,{data:radarChartData,options:radarChartOptions})})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uCE74\\uD14C\\uACE0\\uB9AC\\uBCC4 \\uC810\\uC218\"}),/*#__PURE__*/_jsx(ChartContainer,{children:/*#__PURE__*/_jsx(Bar,{data:barChartData,options:barChartOptions})})]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uD658\\uC790 \\uD2B9\\uC774\\uC0AC\\uD56D\"}),(!surveyData||(!surveyData.q12_reasons||Object.keys(surveyData.q12_reasons).length===0)&&(!surveyData.q13||parseInt(surveyData.q13)<3)&&(!surveyData.q15_reasons||Object.keys(surveyData.q15_reasons).length===0))&&/*#__PURE__*/_jsx(EmptyState,{children:\"\\uD2B9\\uC774\\uC0AC\\uD56D \\uC815\\uBCF4\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}),surveyData&&/*#__PURE__*/_jsxs(\"div\",{style:{display:'grid',gridTemplateColumns:'repeat(auto-fit, minmax(300px, 1fr))',gap:'1.5rem'},children:[surveyData.q12_reasons&&Object.keys(surveyData.q12_reasons).length>0&&/*#__PURE__*/_jsxs(SpecialNoteContainer,{children:[/*#__PURE__*/_jsx(SpecialNoteTitle,{children:\"\\uAC74\\uAC15\\uAD00\\uB9AC\\uC5D0 \\uC5B4\\uB824\\uC6C0\\uC774 \\uC788\\uB294 \\uC774\\uC720\"}),/*#__PURE__*/_jsx(SpecialNoteList,{children:Object.entries(surveyData.q12_reasons).map(_ref2=>{let[index,reason]=_ref2;return/*#__PURE__*/_jsx(\"li\",{children:reason},index);})})]}),surveyData.q13&&parseInt(surveyData.q13)>=3&&/*#__PURE__*/_jsxs(SpecialNoteContainer,{children:[/*#__PURE__*/_jsx(SpecialNoteTitle,{children:\"\\uC2DD\\uC774\\uC870\\uC808 \\uBC29\\uC2DD\"}),/*#__PURE__*/_jsx(SpecialNoteList,{children:[1,2,3,4,5,6].map(subNum=>{const subQuestionKey=`q13_1_${subNum}`;if(surveyData[subQuestionKey]&&parseInt(surveyData[subQuestionKey])>=3){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"div\",{children:surveyQuestions[subQuestionKey]}),/*#__PURE__*/_jsx(ScoreBadge,{children:getScoreDescription(surveyData[subQuestionKey])})]},subNum);}return null;}).filter(Boolean)})]}),surveyData.q15_reasons&&Object.keys(surveyData.q15_reasons).length>0&&/*#__PURE__*/_jsxs(SpecialNoteContainer,{children:[/*#__PURE__*/_jsx(SpecialNoteTitle,{children:\"\\uAC00\\uC871 \\uC9C0\\uC9C0\\uAC00 \\uBD80\\uC871\\uD55C \\uC774\\uC720\"}),/*#__PURE__*/_jsx(SpecialNoteList,{children:Object.entries(surveyData.q15_reasons).map(_ref3=>{let[index,reason]=_ref3;return/*#__PURE__*/_jsx(\"li\",{children:reason},index);})})]})]})]})]}),activeTab==='counseling'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uD658\\uC790 \\uC124\\uBB38 \\uACB0\\uACFC \\uD53C\\uB4DC\\uBC31\"}),!patient||!surveyData||!surveyData.overallFeedback&&!surveyData.additionalFeedback?/*#__PURE__*/_jsxs(NoFeedbackState,{children:[\"\\uC544\\uC9C1 \\uC124\\uBB38 \\uACB0\\uACFC \\uD53C\\uB4DC\\uBC31\\uC774 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\",/*#__PURE__*/_jsx(\"br\",{}),\"\\uD658\\uC790\\uAC00 \\uC124\\uBB38\\uC744 \\uC644\\uB8CC\\uD558\\uBA74 \\uD53C\\uB4DC\\uBC31\\uC774 \\uD45C\\uC2DC\\uB429\\uB2C8\\uB2E4.\"]}):/*#__PURE__*/_jsxs(FeedbackContainer,{children:[/*#__PURE__*/_jsx(FeedbackTitle,{children:\"\\uC81C\\uACF5\\uB41C \\uAC74\\uAC15 \\uAD00\\uB9AC \\uAC00\\uC774\\uB4DC\"}),surveyData.overallFeedback&&/*#__PURE__*/_jsxs(FeedbackSection,{children:[/*#__PURE__*/_jsx(FeedbackSectionTitle,{type:\"overall\",children:\"\\uC885\\uD569 \\uD3C9\\uAC00 \\uBC0F \\uAD8C\\uC7A5\\uC0AC\\uD56D\"}),/*#__PURE__*/_jsx(FeedbackContent,{children:surveyData.overallFeedback})]}),surveyData.additionalFeedback&&/*#__PURE__*/_jsxs(FeedbackSection,{children:[/*#__PURE__*/_jsx(FeedbackSectionTitle,{type:\"additional\",children:\"\\uCD94\\uAC00 \\uC870\\uC5B8 \\uBC0F \\uCC38\\uACE0\\uC0AC\\uD56D\"}),/*#__PURE__*/_jsx(FeedbackContent,{children:surveyData.additionalFeedback})]})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uC0C1\\uB2F4 \\uB178\\uD2B8 \\uC791\\uC131\"}),/*#__PURE__*/_jsxs(NoteForm,{onSubmit:handleAddNote,children:[/*#__PURE__*/_jsx(TextArea,{value:newNote,onChange:e=>setNewNote(e.target.value),placeholder:\"\\uD658\\uC790\\uC640\\uC758 \\uC0C1\\uB2F4 \\uB0B4\\uC6A9, \\uAD00\\uCC30 \\uC0AC\\uD56D, \\uD6C4\\uC18D \\uC870\\uCE58 \\uB4F1\\uC744 \\uAE30\\uB85D\\uD558\\uC138\\uC694...\"}),/*#__PURE__*/_jsx(Button,{type:\"submit\",children:\"\\uB178\\uD2B8 \\uC800\\uC7A5\"})]})]}),/*#__PURE__*/_jsxs(Card,{children:[/*#__PURE__*/_jsx(CardTitle,{children:\"\\uC0C1\\uB2F4 \\uB178\\uD2B8 \\uAE30\\uB85D\"}),notes.length===0?/*#__PURE__*/_jsx(EmptyState,{children:\"\\uC544\\uC9C1 \\uC0C1\\uB2F4 \\uB178\\uD2B8\\uAC00 \\uC5C6\\uC2B5\\uB2C8\\uB2E4.\"}):/*#__PURE__*/_jsx(NotesList,{children:notes.map(note=>/*#__PURE__*/_jsxs(NoteItem,{children:[/*#__PURE__*/_jsxs(NoteHeader,{children:[/*#__PURE__*/_jsx(NoteInfo,{children:/*#__PURE__*/_jsx(NoteDate,{children:note.createdAt.toLocaleString()})}),editNoteId!==note.id&&/*#__PURE__*/_jsxs(NoteActions,{children:[/*#__PURE__*/_jsxs(NoteActionButton,{onClick:()=>handleEditMode(note),children:[/*#__PURE__*/_jsx(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:/*#__PURE__*/_jsx(\"path\",{d:\"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z\"})}),\"\\uC218\\uC815\"]}),/*#__PURE__*/_jsxs(NoteActionButton,{delete:true,onClick:()=>handleDeleteNote(note.id),children:[/*#__PURE__*/_jsxs(\"svg\",{xmlns:\"http://www.w3.org/2000/svg\",width:\"16\",height:\"16\",viewBox:\"0 0 24 24\",fill:\"none\",stroke:\"currentColor\",strokeWidth:\"2\",strokeLinecap:\"round\",strokeLinejoin:\"round\",children:[/*#__PURE__*/_jsx(\"polyline\",{points:\"3 6 5 6 21 6\"}),/*#__PURE__*/_jsx(\"path\",{d:\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2 2h4a2 2 0 0 1 2 2v2\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"10\",y1:\"11\",x2:\"10\",y2:\"17\"}),/*#__PURE__*/_jsx(\"line\",{x1:\"14\",y1:\"11\",x2:\"14\",y2:\"17\"})]}),\"\\uC0AD\\uC81C\"]})]})]}),editNoteId===note.id?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(NoteEditTextArea,{value:editNoteContent,onChange:e=>setEditNoteContent(e.target.value)}),/*#__PURE__*/_jsxs(EditButtonGroup,{children:[/*#__PURE__*/_jsx(Button,{secondary:true,onClick:handleCancelEdit,children:\"\\uCDE8\\uC18C\"}),/*#__PURE__*/_jsx(Button,{onClick:()=>handleUpdateNote(note.id),children:\"\\uC800\\uC7A5\"})]})]}):/*#__PURE__*/_jsx(NoteContent,{children:note.content})]},note.id))})]})]})]})});}export default PatientDetailPage;","map":{"version":3,"names":["React","useState","useEffect","useParams","Link","useNavigate","useLocation","styled","Layout","doc","getDoc","collection","query","where","getDocs","orderBy","addDoc","serverTimestamp","updateDoc","deleteDoc","db","Bar","Radar","Chart","ChartJS","CategoryScale","LinearScale","BarElement","RadialLinearScale","PointElement","LineElement","Filler","Tooltip","Legend","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","register","Container","div","BackLink","PatientInfo","PatientAvatar","PatientNameContainer","PatientName","h2","PatientId","p","Button","button","props","secondary","TabNav","TabButton","active","Card","CardTitle","h3","InfoGrid","InfoGroup","InfoLabel","InfoValue","ChartContainer","TwoColumnGrid","CounselingRequestsList","CounselingRequestItem","CounselingRequestHeader","CounselingRequestTitle","h4","Badge","span","status","type","CounselingRequestMeta","NoteForm","form","TextArea","textarea","NotesList","NoteItem","NoteHeader","NoteInfo","NoteDate","NoteActions","NoteActionButton","delete","NoteContent","NoteEditTextArea","EditButtonGroup","ScoreCardsContainer","ScoreCard","ScoreValue","score","EmptyScore","ScoreLabel","EmptyState","TreatmentTagsContainer","TreatmentTag","SpecialNoteContainer","SpecialNoteTitle","SpecialNoteList","ul","ScoreBadge","FeedbackContainer","FeedbackTitle","FeedbackSection","FeedbackSectionTitle","FeedbackContent","NoFeedbackState","getRequestStatusText","statuses","domainStats","physical","mean","sd","selfcare","support","psychological","social","resilience","PatientDetailPage","patientId","navigate","location","patient","setPatient","counselingRequests","setCounselingRequests","notes","setNotes","newNote","setNewNote","editNoteId","setEditNoteId","editNoteContent","setEditNoteContent","loading","setLoading","error","setError","surveyData","setSurveyData","categoryScores","setCategoryScores","physicalChange","title","healthManagement","socialSupport","psychologicalBurden","socialBurden","activeTab","setActiveTab","queryParams","URLSearchParams","search","tabParam","get","includes","fetchPatientData","patientDocRef","patientDocSnap","exists","userData","data","riskLevel","surveyResults","length","stdScores","validScores","Object","values","forEach","isNaN","push","averageScore","reduce","sum","mentalHealthHistory","mentalHealthImpact","answers","alcoholAbstinence","smokingCessation","q32","q32Score","parseInt","q33","q33Score","mentalHealthDiagnosesText","mentalHealthDiagnoses","diagnoses","depression","anxietyDisorder","schizophrenia","other","join","calculateAge","birthDate","today","Date","birth","getTime","age","getFullYear","monthDiff","getMonth","getDate","calculatedAge","patientData","id","name","gender","maritalStatus","cancerType","cancerStage","diagnosisDate","hasRecurrence","hasSurgery","surgeryDate","otherCancerDiagnosis","otherCancerType","otherCancerDetails","otherMentalDiagnosis","otherTreatmentType","updatedCategoryScores","counselingRequestsRef","q","counselingSnap","requestsData","_doc$data$createdAt","createdAt","toDate","notesRef","notesQuery","e","console","notesSnap","notesData","_doc$data$createdAt2","handleAddNote","preventDefault","trim","noteData","content","authorId","noteDocRef","newNoteWithId","alert","handleEditMode","note","handleCancelEdit","handleUpdateNote","noteId","noteRef","updatedAt","updatedNotes","map","handleDeleteNote","window","confirm","filteredNotes","filter","handleProcessRequest","requestId","getPatientInitials","nameParts","split","toUpperCase","radarChartData","labels","cat","datasets","label","backgroundColor","borderColor","borderWidth","pointBackgroundColor","radarChartOptions","scales","r","angleLines","display","min","max","ticks","stepSize","maintainAspectRatio","barChartData","barChartOptions","responsive","y","beginAtZero","surveyQuestions","q13_1_1","q13_1_2","q13_1_3","q13_1_4","q13_1_5","q13_1_6","getScoreDescription","scoreInt","getScoreLevel","children","to","className","onClick","slice","request","substring","concerns","toLocaleDateString","entries","_ref","key","options","q12_reasons","keys","q13","q15_reasons","style","gridTemplateColumns","gap","_ref2","index","reason","subNum","subQuestionKey","Boolean","_ref3","overallFeedback","additionalFeedback","onSubmit","value","onChange","target","placeholder","toLocaleString","xmlns","width","height","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","d","points","x1","y1","x2","y2"],"sources":["C:/Users/20201/OneDrive/ë°”íƒ• í™”ë©´/patient_survey/web2/src/pages/PatientDetailPage.js"],"sourcesContent":["// src/pages/PatientDetailPage.js\r\nimport React, { useState, useEffect } from 'react';\r\nimport { useParams, Link, useNavigate, useLocation } from 'react-router-dom';\r\nimport styled from 'styled-components';\r\nimport Layout from '../components/Layout';\r\nimport { \r\n  doc, getDoc, collection, query, \r\n  where, getDocs, orderBy, addDoc, \r\n  serverTimestamp, updateDoc, deleteDoc\r\n} from 'firebase/firestore';\r\nimport { db } from '../firebase';\r\nimport { Bar, Radar } from 'react-chartjs-2';\r\nimport {\r\n  Chart as ChartJS,\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  RadialLinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Filler,\r\n  Tooltip,\r\n  Legend,\r\n} from 'chart.js';\r\n\r\n// Chart.js ë“±ë¡\r\nChartJS.register(\r\n  CategoryScale,\r\n  LinearScale,\r\n  BarElement,\r\n  RadialLinearScale,\r\n  PointElement,\r\n  LineElement,\r\n  Filler,\r\n  Tooltip,\r\n  Legend\r\n);\r\n\r\n// ì»¨í…Œì´ë„ˆ\r\nconst Container = styled.div`\r\n  margin-bottom: 2rem;\r\n`;\r\n\r\n// ë’¤ë¡œê°€ê¸° ë§í¬\r\nconst BackLink = styled(Link)`\r\n  display: inline-flex;\r\n  align-items: center;\r\n  font-size: 0.9rem;\r\n  color: #6c757d;\r\n  text-decoration: none;\r\n  margin-bottom: 1rem;\r\n  \r\n  &:hover {\r\n    color: #495057;\r\n  }\r\n`;\r\n\r\n// í™˜ì ì •ë³´ ë ˆì´ì•„ì›ƒ\r\nconst PatientInfo = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 2rem;\r\n\r\n  .patient-details {\r\n    display: flex;\r\n    align-items: center;\r\n  }\r\n`;\r\n\r\n// í™˜ì ì´ë‹ˆì…œ ì•„ë°”íƒ€\r\nconst PatientAvatar = styled.div`\r\n  width: 60px;\r\n  height: 60px;\r\n  border-radius: 50%;\r\n  background-color: #2a5e8c;\r\n  color: white;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 1.5rem;\r\n  font-weight: bold;\r\n  margin-right: 1rem;\r\n`;\r\n\r\n// í™˜ì ì´ë¦„ ë° ID\r\nconst PatientNameContainer = styled.div``;\r\n\r\n// í™˜ì ì´ë¦„\r\nconst PatientName = styled.h2`\r\n  font-size: 1.5rem;\r\n  margin: 0 0 0.5rem;\r\n`;\r\n\r\n// í™˜ì ID\r\nconst PatientId = styled.p`\r\n  color: #6c757d;\r\n  margin: 0;\r\n  font-size: 0.9rem;\r\n`;\r\n\r\n// ë²„íŠ¼\r\nconst Button = styled.button`\r\n  background-color: ${props => props.secondary ? '#6c757d' : '#2a5e8c'};\r\n  color: white;\r\n  border: none;\r\n  border-radius: 4px;\r\n  padding: 0.5rem 1rem;\r\n  font-size: 0.9rem;\r\n  cursor: pointer;\r\n  \r\n  &:hover {\r\n    background-color: ${props => props.secondary ? '#5a6268' : '#1d4269'};\r\n  }\r\n`;\r\n\r\n// íƒ­ ë„¤ë¹„ê²Œì´ì…˜\r\nconst TabNav = styled.div`\r\n  display: flex;\r\n  border-bottom: 1px solid #dee2e6;\r\n  margin-bottom: 2rem;\r\n`;\r\n\r\n// íƒ­ ë²„íŠ¼\r\nconst TabButton = styled.button`\r\n  padding: 0.75rem 1.5rem;\r\n  background: none;\r\n  border: none;\r\n  border-bottom: 2px solid ${props => props.active ? '#2a5e8c' : 'transparent'};\r\n  color: ${props => props.active ? '#2a5e8c' : '#6c757d'};\r\n  font-weight: ${props => props.active ? '600' : '400'};\r\n  cursor: pointer;\r\n  transition: all 0.2s ease-in-out;\r\n  \r\n  &:hover {\r\n    color: #2a5e8c;\r\n  }\r\n`;\r\n\r\n// ì¹´ë“œ\r\nconst Card = styled.div`\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n  padding: 1.5rem;\r\n  margin-bottom: 1.5rem;\r\n`;\r\n\r\n// ì¹´ë“œ ì œëª©\r\nconst CardTitle = styled.h3`\r\n  font-size: 1.1rem;\r\n  margin: 0 0 1.5rem;\r\n  color: #343a40;\r\n  border-bottom: 1px solid #dee2e6;\r\n  padding-bottom: 0.75rem;\r\n`;\r\n\r\n// ì •ë³´ ê·¸ë¦¬ë“œ\r\nconst InfoGrid = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\r\n  gap: 1.5rem;\r\n`;\r\n\r\n// ì •ë³´ ê·¸ë£¹\r\nconst InfoGroup = styled.div`\r\n  margin-bottom: 1rem;\r\n`;\r\n\r\n// ì •ë³´ ë¼ë²¨\r\nconst InfoLabel = styled.p`\r\n  font-size: 0.8rem;\r\n  color: #6c757d;\r\n  margin: 0 0 0.25rem;\r\n`;\r\n\r\n// ì •ë³´ ê°’\r\nconst InfoValue = styled.p`\r\n  margin: 0;\r\n  font-weight: 500;\r\n`;\r\n\r\n// ì°¨íŠ¸ ì»¨í…Œì´ë„ˆ\r\nconst ChartContainer = styled.div`\r\n  height: 300px;\r\n  margin-bottom: 2rem;\r\n`;\r\n\r\n// 2ì—´ ê·¸ë¦¬ë“œ\r\nconst TwoColumnGrid = styled.div`\r\n  display: grid;\r\n  grid-template-columns: 1fr 1fr;\r\n  gap: 1.5rem;\r\n  \r\n  @media (max-width: 992px) {\r\n    grid-template-columns: 1fr;\r\n  }\r\n`;\r\n\r\n// ìƒë‹´ ìš”ì²­ ëª©ë¡\r\nconst CounselingRequestsList = styled.div`\r\n  margin-top: 1.5rem;\r\n`;\r\n\r\n// ìƒë‹´ ìš”ì²­ ì•„ì´í…œ\r\nconst CounselingRequestItem = styled.div`\r\n  padding: 1rem 0;\r\n  border-bottom: 1px solid #dee2e6;\r\n  \r\n  &:last-child {\r\n    border-bottom: none;\r\n  }\r\n`;\r\n\r\n// ìƒë‹´ ìš”ì²­ í—¤ë”\r\nconst CounselingRequestHeader = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 0.5rem;\r\n`;\r\n\r\n// ìƒë‹´ ìš”ì²­ ì œëª©\r\nconst CounselingRequestTitle = styled.h4`\r\n  margin: 0;\r\n  font-size: 1rem;\r\n`;\r\n\r\n// ë°°ì§€\r\nconst Badge = styled.span`\r\n  display: inline-block;\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 50px;\r\n  font-size: 0.75rem;\r\n  font-weight: 700;\r\n  background-color: ${props => {\r\n    if (props.status === 'pending') return '#ffc107';\r\n    if (props.status === 'accepted') return '#28a745';\r\n    if (props.status === 'completed') return '#6c757d';\r\n    if (props.type === 'high') return '#dc3545';\r\n    if (props.type === 'medium') return '#ffc107';\r\n    return '#28a745';\r\n  }};\r\n  color: white;\r\n`;\r\n\r\n// ìƒë‹´ ìš”ì²­ ë©”íƒ€ ì •ë³´\r\nconst CounselingRequestMeta = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  color: #6c757d;\r\n  font-size: 0.8rem;\r\n`;\r\n\r\n// ìƒë‹´ ë…¸íŠ¸ ì…ë ¥ í¼\r\nconst NoteForm = styled.form`\r\n  margin-top: 2rem;\r\n`;\r\n\r\n// ì…ë ¥ í•„ë“œ\r\nconst TextArea = styled.textarea`\r\n  width: 100%;\r\n  padding: 0.75rem;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  resize: vertical;\r\n  min-height: 100px;\r\n  margin-bottom: 1rem;\r\n`;\r\n\r\n// ìƒë‹´ ë…¸íŠ¸ ëª©ë¡\r\nconst NotesList = styled.div`\r\n  margin-top: 1.5rem;\r\n`;\r\n\r\n// ìƒë‹´ ë…¸íŠ¸ ì•„ì´í…œ\r\nconst NoteItem = styled.div`\r\n  padding: 1rem;\r\n  border-bottom: 1px solid #dee2e6;\r\n  \r\n  &:last-child {\r\n    border-bottom: none;\r\n  }\r\n`;\r\n\r\n// ë…¸íŠ¸ í—¤ë”\r\nconst NoteHeader = styled.div`\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 0.5rem;\r\n`;\r\n\r\n// ë…¸íŠ¸ ì •ë³´ ì˜ì—­\r\nconst NoteInfo = styled.div`\r\n  display: flex;\r\n  flex-direction: column;\r\n`;\r\n\r\n// ë…¸íŠ¸ ë‚ ì§œ\r\nconst NoteDate = styled.span`\r\n  color: #6c757d;\r\n  font-size: 0.8rem;\r\n`;\r\n\r\n// ë…¸íŠ¸ ì•¡ì…˜ ë²„íŠ¼ ì˜ì—­\r\nconst NoteActions = styled.div`\r\n  display: flex;\r\n  gap: 0.5rem;\r\n`;\r\n\r\n// ë…¸íŠ¸ ì•¡ì…˜ ë²„íŠ¼\r\nconst NoteActionButton = styled.button`\r\n  background: none;\r\n  border: none;\r\n  color: ${props => props.delete ? '#dc3545' : '#2a5e8c'};\r\n  font-size: 0.85rem;\r\n  cursor: pointer;\r\n  display: flex;\r\n  align-items: center;\r\n  padding: 0.25rem 0.5rem;\r\n  border-radius: 4px;\r\n  \r\n  &:hover {\r\n    background-color: ${props => props.delete ? '#f8d7da' : '#e6f2fa'};\r\n  }\r\n  \r\n  svg {\r\n    margin-right: 0.25rem;\r\n  }\r\n`;\r\n\r\n// ë…¸íŠ¸ ë‚´ìš©\r\nconst NoteContent = styled.p`\r\n  margin: 0;\r\n  white-space: pre-line;\r\n`;\r\n\r\n// ë…¸íŠ¸ ìˆ˜ì • ì…ë ¥ í•„ë“œ\r\nconst NoteEditTextArea = styled.textarea`\r\n  width: 100%;\r\n  padding: 0.75rem;\r\n  border: 1px solid #ced4da;\r\n  border-radius: 4px;\r\n  resize: vertical;\r\n  min-height: 100px;\r\n  margin-bottom: 1rem;\r\n`;\r\n\r\n// ë…¸íŠ¸ í¸ì§‘ ë²„íŠ¼ ê·¸ë£¹\r\nconst EditButtonGroup = styled.div`\r\n  display: flex;\r\n  gap: 0.5rem;\r\n  justify-content: flex-end;\r\n`;\r\n\r\n// ìŠ¤ì½”ì–´ì¹´ë“œ ì»¨í…Œì´ë„ˆ\r\nconst ScoreCardsContainer = styled.div`\r\n  display: grid;\r\n  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\r\n  gap: 1rem;\r\n  margin-bottom: 1.5rem;\r\n`;\r\n\r\n// ìŠ¤ì½”ì–´ì¹´ë“œ\r\nconst ScoreCard = styled.div`\r\n  background-color: white;\r\n  border-radius: 8px;\r\n  padding: 1rem;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n`;\r\n\r\n// ìŠ¤ì½”ì–´ì¹´ë“œ ê°’\r\nconst ScoreValue = styled.div`\r\n  font-size: 1.8rem;\r\n  font-weight: 700;\r\n  color: ${props => {\r\n    if (props.score === null) return '#6c757d';\r\n    if (props.score >= 50) return '#28a745';\r\n    if (props.score >= 40) return '#ffc107';\r\n    return '#dc3545';\r\n  }};\r\n`;\r\n\r\n// ë¹ˆ ì ìˆ˜ í‘œì‹œë¥¼ ìœ„í•œ ìŠ¤íƒ€ì¼\r\nconst EmptyScore = styled.div`\r\n  font-size: 1.2rem;\r\n  color: #6c757d;\r\n  font-style: italic;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  \r\n  &::before {\r\n    content: \"â€”\";\r\n    font-size: 2rem;\r\n    font-style: normal;\r\n  }\r\n`;\r\n\r\n// ìŠ¤ì½”ì–´ì¹´ë“œ ë¼ë²¨\r\nconst ScoreLabel = styled.div`\r\n  font-size: 0.8rem;\r\n  color: #6c757d;\r\n  text-align: center;\r\n  margin-bottom: 0.5rem;\r\n`;\r\n\r\n// ë¹ˆ ìƒíƒœ ë©”ì‹œì§€\r\nconst EmptyState = styled.div`\r\n  text-align: center;\r\n  padding: 2rem;\r\n  color: #6c757d;\r\n`;\r\n\r\n// ì¹˜ë£Œ íƒœê·¸ ì»¨í…Œì´ë„ˆ\r\nconst TreatmentTagsContainer = styled.div`\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 0.5rem;\r\n  margin-top: 0.5rem;\r\n`;\r\n\r\n// ì¹˜ë£Œ íƒœê·¸\r\nconst TreatmentTag = styled.span`\r\n  background-color: #e9ecef;\r\n  color: #495057;\r\n  border-radius: 16px;\r\n  padding: 0.25rem 0.75rem;\r\n  font-size: 0.8rem;\r\n`;\r\n\r\n// íŠ¹ì´ì‚¬í•­ ì»¨í…Œì´ë„ˆ\r\nconst SpecialNoteContainer = styled.div`\r\n  background-color: #f8f9fa;\r\n  border-radius: 10px;\r\n  padding: 1.25rem;\r\n  box-shadow: 0 2px 4px rgba(0,0,0,0.05);\r\n  border-left: 4px solid #2a5e8c;\r\n`;\r\n\r\n// íŠ¹ì´ì‚¬í•­ ì œëª©\r\nconst SpecialNoteTitle = styled.h4`\r\n  font-size: 1rem;\r\n  color: #2a5e8c;\r\n  margin-top: 0;\r\n  margin-bottom: 1rem;\r\n  font-weight: 600;\r\n`;\r\n\r\n// íŠ¹ì´ì‚¬í•­ ëª©ë¡\r\nconst SpecialNoteList = styled.ul`\r\n  margin: 0;\r\n  padding-left: 1.25rem;\r\n  color: #495057;\r\n  \r\n  li {\r\n    margin-bottom: 0.5rem;\r\n  }\r\n`;\r\n\r\n// ì‘ë‹µ ì ìˆ˜ ë°°ì§€\r\nconst ScoreBadge = styled.div`\r\n  display: inline-block;\r\n  margin-top: 0.25rem;\r\n  font-size: 0.85rem;\r\n  padding: 0.15rem 0.5rem;\r\n  background-color: #e9ecef;\r\n  border-radius: 12px;\r\n  color: #2a5e8c;\r\n`;\r\n\r\n// í”¼ë“œë°± ì»¨í…Œì´ë„ˆ\r\nconst FeedbackContainer = styled.div`\r\n  background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);\r\n  border-radius: 12px;\r\n  padding: 1.5rem;\r\n  margin-bottom: 1.5rem;\r\n  border-left: 4px solid #2a5e8c;\r\n  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\r\n`;\r\n\r\n// í”¼ë“œë°± ì œëª©\r\nconst FeedbackTitle = styled.h3`\r\n  color: #2a5e8c;\r\n  font-size: 1.2rem;\r\n  margin: 0 0 1.5rem 0;\r\n  display: flex;\r\n  align-items: center;\r\n  font-weight: 600;\r\n  \r\n  &::before {\r\n    content: \"ğŸ’¬\";\r\n    margin-right: 0.5rem;\r\n    font-size: 1.1rem;\r\n  }\r\n`;\r\n\r\n// í”¼ë“œë°± ì„¹ì…˜\r\nconst FeedbackSection = styled.div`\r\n  background: white;\r\n  border-radius: 8px;\r\n  padding: 1.25rem;\r\n  margin-bottom: 1rem;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);\r\n  border: 1px solid #e9ecef;\r\n  \r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n`;\r\n\r\n// í”¼ë“œë°± ì„¹ì…˜ ì œëª©\r\nconst FeedbackSectionTitle = styled.h4`\r\n  color: #495057;\r\n  font-size: 1rem;\r\n  margin: 0 0 0.75rem 0;\r\n  font-weight: 600;\r\n  display: flex;\r\n  align-items: center;\r\n  \r\n  &::before {\r\n    content: ${props => props.type === 'overall' ? '\"ğŸ“Š\"' : '\"ğŸ’¡\"'};\r\n    margin-right: 0.5rem;\r\n    font-size: 0.9rem;\r\n  }\r\n`;\r\n\r\n// í”¼ë“œë°± ë‚´ìš©\r\nconst FeedbackContent = styled.div`\r\n  color: #495057;\r\n  line-height: 1.6;\r\n  font-size: 0.95rem;\r\n  white-space: pre-line;\r\n  \r\n  p {\r\n    margin: 0 0 0.75rem 0;\r\n    \r\n    &:last-child {\r\n      margin-bottom: 0;\r\n    }\r\n  }\r\n`;\r\n\r\n// í”¼ë“œë°± ì—†ìŒ ìƒíƒœ\r\nconst NoFeedbackState = styled.div`\r\n  text-align: center;\r\n  padding: 2rem;\r\n  color: #6c757d;\r\n  background: white;\r\n  border-radius: 8px;\r\n  border: 2px dashed #dee2e6;\r\n  \r\n  &::before {\r\n    content: \"ğŸ“\";\r\n    display: block;\r\n    font-size: 2rem;\r\n    margin-bottom: 0.5rem;\r\n  }\r\n`;\r\n\r\n// ìƒë‹´ ìš”ì²­ ìƒíƒœë¥¼ í•œê¸€ë¡œ ë³€í™˜\r\nconst getRequestStatusText = (status) => {\r\n  const statuses = {\r\n    'pending': 'ëŒ€ê¸° ì¤‘',\r\n    'accepted': 'ì˜ˆì•½ í™•ì •',\r\n    'completed': 'ì™„ë£Œ',\r\n    'cancelled': 'ì·¨ì†Œë¨'\r\n  };\r\n  return statuses[status] || 'ì•Œ ìˆ˜ ì—†ìŒ';\r\n};\r\n\r\n// ì˜ì—­ë³„ í‰ê·  ë° í‘œì¤€í¸ì°¨ ì •ë³´ (ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•Šì§€ë§Œ ê¸°ì¡´ ì½”ë“œì™€ì˜ í˜¸í™˜ì„±ì„ ìœ„í•´ ìœ ì§€)\r\nconst domainStats = {\r\n  physical: { mean: 3.09, sd: 0.95 },\r\n  selfcare: { mean: 3.63, sd: 0.76 },\r\n  support: { mean: 3.84, sd: 0.94 },\r\n  psychological: { mean: 3.08, sd: 0.91 },\r\n  social: { mean: 3.39, sd: 1.20 },\r\n  resilience: { mean: 4.28, sd: 0.72 }\r\n};\r\n\r\nfunction PatientDetailPage() {\r\n  const { patientId } = useParams();\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  \r\n  const [patient, setPatient] = useState(null);\r\n  const [counselingRequests, setCounselingRequests] = useState([]);\r\n  const [notes, setNotes] = useState([]);\r\n  const [newNote, setNewNote] = useState('');\r\n  const [editNoteId, setEditNoteId] = useState(null); // í˜„ì¬ ìˆ˜ì • ì¤‘ì¸ ë…¸íŠ¸ ID\r\n  const [editNoteContent, setEditNoteContent] = useState(''); // ìˆ˜ì • ì¤‘ì¸ ë…¸íŠ¸ ë‚´ìš©\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [surveyData, setSurveyData] = useState(null);\r\n  const [categoryScores, setCategoryScores] = useState({\r\n    physicalChange: { title: 'ì‹ ì²´ì  ë³€í™”', score: 0 },\r\n    healthManagement: { title: 'ê±´ê°• ê´€ë¦¬', score: 0 },\r\n    socialSupport: { title: 'ì‚¬íšŒì  ì§€ì§€', score: 0 },\r\n    psychologicalBurden: { title: 'ì‹¬ë¦¬ì  ë¶€ë‹´', score: 0 },\r\n    socialBurden: { title: 'ì‚¬íšŒì  ë¶€ë‹´', score: 0 },\r\n    resilience: { title: 'íšŒë³µ íƒ„ë ¥ì„±', score: 0 }\r\n  });\r\n  \r\n  // URLì—ì„œ íƒ­ íŒŒë¼ë¯¸í„°ë¥¼ ì½ì–´ì™€ì„œ ì´ˆê¸° íƒ­ ì„¤ì •\r\n  const [activeTab, setActiveTab] = useState('overview');\r\n  \r\n  useEffect(() => {\r\n    // URL ì¿¼ë¦¬ íŒŒë¼ë¯¸í„°ì—ì„œ tab ê°’ì„ ì½ì–´ì˜´\r\n    const queryParams = new URLSearchParams(location.search);\r\n    const tabParam = queryParams.get('tab');\r\n    \r\n    // tab íŒŒë¼ë¯¸í„°ê°€ ìˆìœ¼ë©´ í•´ë‹¹ íƒ­ì„ í™œì„±í™”\r\n    if (tabParam && ['overview', 'survey', 'counseling'].includes(tabParam)) {\r\n      setActiveTab(tabParam);\r\n    }\r\n  }, [location]);\r\n  \r\n  // í™˜ì ë°ì´í„° ë° ê´€ë ¨ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸°\r\n  useEffect(() => {\r\n    const fetchPatientData = async () => {\r\n      try {\r\n        // í™˜ì ê¸°ë³¸ ì •ë³´ ë¶ˆëŸ¬ì˜¤ê¸° - users ì»¬ë ‰ì…˜ì—ì„œ ê°€ì ¸ì˜¤ê¸°\r\n        const patientDocRef = doc(db, \"users\", patientId);\r\n        const patientDocSnap = await getDoc(patientDocRef);\r\n        \r\n        if (!patientDocSnap.exists()) {\r\n          setError('í™˜ì ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');\r\n          setLoading(false);\r\n          return;\r\n        }\r\n        \r\n        const userData = patientDocSnap.data();\r\n        \r\n        // ìœ„í—˜ë„ ê²°ì • - ì„¤ë¬¸ì¡°ì‚¬ ì „ì²´ ì´ì  newScore ê¸°ë°˜\r\n        let riskLevel = 'low'; // ê¸°ë³¸ê°’ì€ ì–‘í˜¸\r\n        \r\n        // ì„¤ë¬¸ ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ newScore ê¸°ë°˜ ìœ„í—˜ë„ ê³„ì‚°\r\n        if (userData.surveyResults && userData.surveyResults.length > 0 && userData.surveyResults[0].stdScores) {\r\n          const stdScores = userData.surveyResults[0].stdScores;\r\n          \r\n          // ëª¨ë“  ìœ íš¨í•œ ì ìˆ˜ë“¤ì˜ í‰ê·  ê³„ì‚°\r\n          const validScores = [];\r\n          Object.values(stdScores).forEach(score => {\r\n            if (typeof score === 'number' && !isNaN(score)) {\r\n              validScores.push(score);\r\n            }\r\n          });\r\n          \r\n          if (validScores.length > 0) {\r\n            const averageScore = validScores.reduce((sum, score) => sum + score, 0) / validScores.length;\r\n            \r\n            // í‰ê·  ì ìˆ˜ ê¸°ì¤€ìœ¼ë¡œ ìœ„í—˜ë„ ê²°ì •\r\n            if (averageScore < 40) {\r\n              riskLevel = 'high'; // 40ì  ë¯¸ë§Œì€ ìœ„í—˜\r\n            } else if (averageScore < 50) {\r\n              riskLevel = 'medium'; // 40~49ì ì€ ì£¼ì˜\r\n            } else {\r\n              riskLevel = 'low'; // 50ì  ì´ìƒì€ ì–‘í˜¸\r\n            }\r\n          }\r\n        } else {\r\n          // ì„¤ë¬¸ ë°ì´í„°ê°€ ì—†ëŠ” ê²½ìš° ê¸°ì¡´ ë¡œì§ìœ¼ë¡œ ëŒ€ì²´\r\n          if (userData.mentalHealthHistory && userData.mentalHealthHistory !== \"ì•„ë‹ˆì˜¤\") {\r\n            riskLevel = 'high';\r\n          } else if (userData.mentalHealthImpact) {\r\n            riskLevel = 'medium';\r\n          }\r\n        }\r\n        \r\n        // ì„¤ë¬¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° - answers í•„ë“œì—ì„œ ê°€ì ¸ì˜¤ê¸°\r\n        const answers = userData.answers || {};\r\n        \r\n        // q32(ì ˆì£¼), q33(ê¸ˆì—°) ë°ì´í„° í™•ì¸\r\n        let alcoholAbstinence = 'ì •ë³´ ì—†ìŒ';\r\n        let smokingCessation = 'ì •ë³´ ì—†ìŒ';\r\n        \r\n        if (answers.q32) {\r\n          const q32Score = parseInt(answers.q32);\r\n          // ì ìˆ˜ê°€ 3ì  ì´ìƒì´ë©´ \"ì˜ˆ\", ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ \"ì•„ë‹ˆì˜¤\"\r\n          alcoholAbstinence = q32Score >= 3 ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤';\r\n        }\r\n        \r\n        if (answers.q33) {\r\n          const q33Score = parseInt(answers.q33);\r\n          // ì ìˆ˜ê°€ 3ì  ì´ìƒì´ë©´ \"ì˜ˆ\", ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ \"ì•„ë‹ˆì˜¤\"\r\n          smokingCessation = q33Score >= 3 ? 'ì˜ˆ' : 'ì•„ë‹ˆì˜¤';\r\n        }\r\n        \r\n        // ì •ì‹ ê±´ê°• ì§„ë‹¨ëª…ë“¤ì„ ë¬¸ìì—´ë¡œ ë³€í™˜\r\n        let mentalHealthDiagnosesText = 'ì—†ìŒ';\r\n        if (userData.mentalHealthDiagnoses) {\r\n          const diagnoses = [];\r\n          if (userData.mentalHealthDiagnoses.depression) diagnoses.push('ìš°ìš¸ì¦');\r\n          if (userData.mentalHealthDiagnoses.anxietyDisorder) diagnoses.push('ë¶ˆì•ˆì¥ì• ');\r\n          if (userData.mentalHealthDiagnoses.schizophrenia) diagnoses.push('ì¡°í˜„ë³‘');\r\n          if (userData.mentalHealthDiagnoses.other) diagnoses.push('ê¸°íƒ€');\r\n          \r\n          if (diagnoses.length > 0) {\r\n            mentalHealthDiagnosesText = diagnoses.join(', ');\r\n          }\r\n        }\r\n        \r\n        // ìƒë…„ì›”ì¼ë¡œë¶€í„° ë‚˜ì´ ê³„ì‚°\r\n        const calculateAge = (birthDate) => {\r\n          if (!birthDate) return null;\r\n          \r\n          const today = new Date();\r\n          const birth = new Date(birthDate);\r\n          \r\n          if (isNaN(birth.getTime())) return null;\r\n          \r\n          let age = today.getFullYear() - birth.getFullYear();\r\n          const monthDiff = today.getMonth() - birth.getMonth();\r\n          \r\n          if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birth.getDate())) {\r\n            age--;\r\n          }\r\n          \r\n          return age;\r\n        };\r\n        \r\n        const calculatedAge = calculateAge(userData.birthDate);\r\n        \r\n        const patientData = {\r\n          id: patientDocSnap.id,\r\n          name: userData.name || 'ìµëª…',\r\n          gender: userData.gender || '',\r\n          birthDate: userData.birthDate || '',\r\n          age: calculatedAge,\r\n          maritalStatus: userData.maritalStatus || '',\r\n          cancerType: userData.cancerType || '',\r\n          cancerStage: userData.cancerStage || '',\r\n          diagnosisDate: userData.diagnosisDate || '',\r\n          hasRecurrence: userData.hasRecurrence || '',\r\n          hasSurgery: userData.hasSurgery || '',\r\n          surgeryDate: userData.surgeryDate || '',\r\n          otherCancerDiagnosis: userData.otherCancerDiagnosis || '',\r\n          otherCancerType: userData.otherCancerType || '',\r\n          otherCancerDetails: userData.otherCancerDetails || '',\r\n          mentalHealthHistory: userData.mentalHealthHistory || '',\r\n          mentalHealthDiagnoses: mentalHealthDiagnosesText,\r\n          otherMentalDiagnosis: userData.otherMentalDiagnosis || '',\r\n          mentalHealthImpact: userData.mentalHealthImpact || '',\r\n          otherTreatmentType: userData.otherTreatmentType || '',\r\n          alcoholAbstinence: alcoholAbstinence,  // ì ˆì£¼ ì—¬ë¶€ ì¶”ê°€\r\n          smokingCessation: smokingCessation,    // ê¸ˆì—° ì—¬ë¶€ ì¶”ê°€\r\n          riskLevel\r\n        };\r\n        \r\n        setPatient(patientData);\r\n        \r\n        if (userData.surveyResults && userData.surveyResults.length > 0 && userData.surveyResults[0].stdScores) {\r\n          setSurveyData(userData.answers || {});\r\n          \r\n          const stdScores = userData.surveyResults[0].stdScores;\r\n          \r\n          // ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜ ì„¤ì • (ë””ë¹„ì—ì„œ ì§ì ‘ ê°€ì ¸ì˜¨ ì ìˆ˜ ì‚¬ìš©)\r\n          const updatedCategoryScores = {\r\n            physicalChange: { \r\n              title: 'ì‹ ì²´ì  ë³€í™”', \r\n              score: typeof stdScores.physicalChange === 'number' ? stdScores.physicalChange : null \r\n            },\r\n            healthManagement: { \r\n              title: 'ê±´ê°• ê´€ë¦¬', \r\n              score: typeof stdScores.healthManagement === 'number' ? stdScores.healthManagement : null \r\n            },\r\n            socialSupport: { \r\n              title: 'ì‚¬íšŒì  ì§€ì§€', \r\n              score: typeof stdScores.socialSupport === 'number' ? stdScores.socialSupport : null \r\n            },\r\n            psychologicalBurden: { \r\n              title: 'ì‹¬ë¦¬ì  ë¶€ë‹´', \r\n              score: typeof stdScores.psychologicalBurden === 'number' ? stdScores.psychologicalBurden : null \r\n            },\r\n            socialBurden: { \r\n              title: 'ì‚¬íšŒì  ë¶€ë‹´', \r\n              score: typeof stdScores.socialBurden === 'number' ? stdScores.socialBurden : null \r\n            },\r\n            resilience: { \r\n              title: 'íšŒë³µ íƒ„ë ¥ì„±', \r\n              score: typeof stdScores.resilience === 'number' ? stdScores.resilience : null \r\n            }\r\n          };\r\n          \r\n          setCategoryScores(updatedCategoryScores);\r\n        }\r\n\r\n        \r\n        // ìƒë‹´ ìš”ì²­ ë¶ˆëŸ¬ì˜¤ê¸°\r\n        const counselingRequestsRef = collection(db, \"counselingRequests\");\r\n        const q = query(\r\n          counselingRequestsRef,\r\n          where(\"userId\", \"==\", patientId)\r\n        );\r\n        \r\n        const counselingSnap = await getDocs(q);\r\n        const requestsData = [];\r\n        \r\n        counselingSnap.forEach(doc => {\r\n          requestsData.push({\r\n            id: doc.id,\r\n            ...doc.data(),\r\n            createdAt: doc.data().createdAt?.toDate() || new Date()\r\n          });\r\n        });\r\n        \r\n        setCounselingRequests(requestsData);\r\n        \r\n        // ìƒë‹´ ë…¸íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°\r\n        const notesRef = collection(db, \"patients\", patientId, \"notes\");\r\n        let notesQuery = notesRef;\r\n        try {\r\n          notesQuery = query(notesRef, orderBy(\"createdAt\", \"desc\"));\r\n        } catch (e) {\r\n          console.error(\"Error creating notes query with orderBy:\", e);\r\n        }\r\n        \r\n        const notesSnap = await getDocs(notesQuery);\r\n        const notesData = [];\r\n        \r\n        notesSnap.forEach(doc => {\r\n          notesData.push({\r\n            id: doc.id,\r\n            ...doc.data(),\r\n            createdAt: doc.data().createdAt?.toDate() || new Date()\r\n          });\r\n        });\r\n        \r\n        setNotes(notesData);\r\n        \r\n        setLoading(false);\r\n      } catch (error) {\r\n        setError('í™˜ì ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\r\n        setLoading(false);\r\n      }\r\n    };\r\n    \r\n    if (patientId) {\r\n      fetchPatientData();\r\n    }\r\n  }, [patientId]);\r\n\r\n  // ìƒë‹´ ë…¸íŠ¸ ì¶”ê°€\r\n  const handleAddNote = async (e) => {\r\n    e.preventDefault();\r\n    \r\n    if (!newNote.trim()) return;\r\n    \r\n    try {\r\n      const noteData = {\r\n        content: newNote,\r\n        authorId: 'ê´€ë¦¬ì', // ê°„ì†Œí™”ëœ ê¸°ë³¸ ì €ì ID\r\n        createdAt: serverTimestamp()\r\n      };\r\n      \r\n      const noteDocRef = await addDoc(collection(db, \"patients\", patientId, \"notes\"), noteData);\r\n      \r\n      const newNoteWithId = {\r\n        id: noteDocRef.id,\r\n        ...noteData,\r\n        createdAt: new Date()\r\n      };\r\n      \r\n      setNotes([newNoteWithId, ...notes]);\r\n      setNewNote('');\r\n    } catch (error) {\r\n      alert('ìƒë‹´ ë…¸íŠ¸ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\r\n    }\r\n  };\r\n  \r\n  // ìˆ˜ì • ëª¨ë“œ ì§„ì…\r\n  const handleEditMode = (note) => {\r\n    setEditNoteId(note.id);\r\n    setEditNoteContent(note.content);\r\n  };\r\n  \r\n  // ìˆ˜ì • ì·¨ì†Œ\r\n  const handleCancelEdit = () => {\r\n    setEditNoteId(null);\r\n    setEditNoteContent('');\r\n  };\r\n  \r\n  // ë…¸íŠ¸ ìˆ˜ì • ì €ì¥\r\n  const handleUpdateNote = async (noteId) => {\r\n    if (!editNoteContent.trim()) return;\r\n    \r\n    try {\r\n      // Firestore ë¬¸ì„œ ì—…ë°ì´íŠ¸\r\n      const noteRef = doc(db, \"patients\", patientId, \"notes\", noteId);\r\n      await updateDoc(noteRef, {\r\n        content: editNoteContent,\r\n        updatedAt: serverTimestamp()\r\n      });\r\n      \r\n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\r\n      const updatedNotes = notes.map(note => {\r\n        if (note.id === noteId) {\r\n          return {\r\n            ...note,\r\n            content: editNoteContent,\r\n            updatedAt: new Date()\r\n          };\r\n        }\r\n        return note;\r\n      });\r\n      \r\n      setNotes(updatedNotes);\r\n      setEditNoteId(null);\r\n      setEditNoteContent('');\r\n    } catch (error) {\r\n      alert('ìƒë‹´ ë…¸íŠ¸ ìˆ˜ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\r\n    }\r\n  };\r\n  \r\n  // ë…¸íŠ¸ ì‚­ì œ\r\n  const handleDeleteNote = async (noteId) => {\r\n    if (!window.confirm('ì´ ìƒë‹´ ë…¸íŠ¸ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {\r\n      return;\r\n    }\r\n    \r\n    try {\r\n      // Firestore ë¬¸ì„œ ì‚­ì œ\r\n      const noteRef = doc(db, \"patients\", patientId, \"notes\", noteId);\r\n      await deleteDoc(noteRef);\r\n      \r\n      // ë¡œì»¬ ìƒíƒœ ì—…ë°ì´íŠ¸\r\n      const filteredNotes = notes.filter(note => note.id !== noteId);\r\n      setNotes(filteredNotes);\r\n    } catch (error) {\r\n      alert('ìƒë‹´ ë…¸íŠ¸ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');\r\n    }\r\n  };\r\n  \r\n  // ìƒë‹´ ìš”ì²­ ì²˜ë¦¬ í˜ì´ì§€ë¡œ ì´ë™\r\n  const handleProcessRequest = (requestId) => {\r\n    navigate(`/counseling-record/${requestId}`);\r\n  };\r\n  \r\n  // í™˜ì ì´ë‹ˆì…œ ê°€ì ¸ì˜¤ê¸°\r\n  const getPatientInitials = () => {\r\n    if (!patient || !patient.name) return '?';\r\n    \r\n    const nameParts = patient.name.split(' ');\r\n    if (nameParts.length > 1) {\r\n      return `${nameParts[0][0]}${nameParts[1][0]}`.toUpperCase();\r\n    }\r\n    \r\n    return patient.name[0].toUpperCase();\r\n  };\r\n  \r\n  // ë ˆì´ë” ì°¨íŠ¸ ë°ì´í„°\r\n  const radarChartData = {\r\n    labels: Object.values(categoryScores).map(cat => cat.title),\r\n    datasets: [\r\n      {\r\n        label: 'ì·¨ë“ ì ìˆ˜',\r\n        data: Object.values(categoryScores).map(cat => cat.score !== null ? cat.score : 0),\r\n        backgroundColor: 'rgba(42, 94, 140, 0.2)',\r\n        borderColor: 'rgba(42, 94, 140, 1)',\r\n        borderWidth: 2,\r\n        pointBackgroundColor: 'rgba(42, 94, 140, 1)',\r\n      }\r\n    ]\r\n  };\r\n  \r\n  // ë ˆì´ë” ì°¨íŠ¸ ì˜µì…˜\r\n  const radarChartOptions = {\r\n    scales: {\r\n      r: {\r\n        angleLines: {\r\n          display: true\r\n        },\r\n        min: 0,\r\n        max: 100,\r\n        ticks: {\r\n          stepSize: 20\r\n        }\r\n      }\r\n    },\r\n    maintainAspectRatio: false\r\n  };\r\n  \r\n  // ë°” ì°¨íŠ¸ ë°ì´í„°\r\n  const barChartData = {\r\n    labels: Object.values(categoryScores).map(cat => cat.title),\r\n    datasets: [\r\n      {\r\n        label: 'ì·¨ë“ ì ìˆ˜',\r\n        data: Object.values(categoryScores).map(cat => cat.score !== null ? cat.score : 0),\r\n        backgroundColor: 'rgba(42, 94, 140, 0.7)',\r\n      },\r\n      {\r\n        label: 'í‰ê·  ì ìˆ˜',\r\n        data: [41, 54, 60, 40, 48, 71], // ê¸°ì¤€ í‰ê· ê°’\r\n        backgroundColor: 'rgba(220, 220, 220, 0.7)',\r\n      }\r\n    ]\r\n  };\r\n  \r\n  // ë°” ì°¨íŠ¸ ì˜µì…˜\r\n  const barChartOptions = {\r\n    responsive: true,\r\n    scales: {\r\n      y: {\r\n        beginAtZero: true\r\n      }\r\n    },\r\n    maintainAspectRatio: false\r\n  };\r\n  \r\n  // 13-1 ì„¤ë¬¸ ì§ˆë¬¸ ëª©ë¡\r\n  const surveyQuestions = {\r\n    // ì‹ì´ì¡°ì ˆ ì„¸ë¶€ í•­ëª©\r\n    q13_1_1: \"ì¡°ë¯¸ë£Œ ì„­ì·¨ë¥¼ ì¤„ì¸ë‹¤.\",\r\n    q13_1_2: \"ì‹í’ˆì˜ ì‹ ì„ ë„ë¥¼ ì¤‘ìš”ì‹œí•œë‹¤.\",\r\n    q13_1_3: \"ì±„ì‹ ë° ê³¼ì¼ ìœ„ì£¼ì˜ ì‹ìŠµê´€ì„ í•œë‹¤.\",\r\n    q13_1_4: \"ìœ¡ë¥˜ ì„­ì·¨ë¥¼ ì¡°ì ˆí•œë‹¤.\",\r\n    q13_1_5: \"íƒ„ìˆ˜í™”ë¬¼ ì„­ì·¨ë¥¼ ì¡°ì ˆí•œë‹¤.\",\r\n    q13_1_6: \"í•­ì•”ì‹í’ˆ(ì˜ˆ: ë²„ì„¯, ë„ë¼ì§€, ë‘ìœ , í˜„ë¯¸ì‹ ë“±)ì„ ë¨¹ëŠ”ë‹¤.\",\r\n  };\r\n  \r\n  // ì„¤ë¬¸ ì‘ë‹µì— ëŒ€í•œ ì„¤ëª…\r\n  const getScoreDescription = (score) => {\r\n    const scoreInt = parseInt(score);\r\n    switch(scoreInt) {\r\n      case 1: return \"ì „í˜€ ê·¸ë ‡ì§€ ì•Šë‹¤\";\r\n      case 2: return \"ê·¸ë ‡ì§€ ì•Šë‹¤\";\r\n      case 3: return \"ë³´í†µì´ë‹¤\";\r\n      case 4: return \"ê·¸ë ‡ë‹¤\";\r\n      case 5: return \"ë§¤ìš° ê·¸ë ‡ë‹¤\";\r\n      default: return \"ì‘ë‹µ ì—†ìŒ\";\r\n    }\r\n  };\r\n  \r\n  // NewScore í‰ê°€\r\n  const getScoreLevel = (score) => {\r\n    if (score === null) return \"ëŒ€ìƒì™¸\";\r\n    if (score >= 50) return \"ì–‘í˜¸\";\r\n    if (score >= 40) return \"ë³´í†µ\";\r\n    return \"ì£¼ì˜\";\r\n  };\r\n\r\n  if (loading) {\r\n    return (\r\n      <Layout title=\"í™˜ì ìƒì„¸ ì •ë³´\">\r\n        <Container>\r\n          <p>í™˜ì ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>\r\n        </Container>\r\n      </Layout>\r\n    );\r\n  }\r\n  \r\n  if (error) {\r\n    return (\r\n      <Layout title=\"í™˜ì ìƒì„¸ ì •ë³´\">\r\n        <Container>\r\n          <BackLink to=\"/\">â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</BackLink>\r\n          <Card>\r\n            <CardTitle>ì˜¤ë¥˜</CardTitle>\r\n            <p>{error}</p>\r\n          </Card>\r\n        </Container>\r\n      </Layout>\r\n    );\r\n  }\r\n  \r\n  if (!patient) {\r\n    return (\r\n      <Layout title=\"í™˜ì ìƒì„¸ ì •ë³´\">\r\n        <Container>\r\n          <BackLink to=\"/\">â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</BackLink>\r\n          <Card>\r\n            <CardTitle>í™˜ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ</CardTitle>\r\n            <p>í•´ë‹¹ IDì˜ í™˜ìë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>\r\n          </Card>\r\n        </Container>\r\n      </Layout>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Layout title=\"í™˜ì ìƒì„¸ ì •ë³´\">\r\n      <Container>\r\n        <BackLink to=\"/\">â† ëŒ€ì‹œë³´ë“œë¡œ ëŒì•„ê°€ê¸°</BackLink>\r\n        \r\n        <PatientInfo>\r\n          <div className=\"patient-details\">\r\n            <PatientAvatar>{getPatientInitials()}</PatientAvatar>\r\n            <PatientNameContainer>\r\n              <PatientName>{patient.name || 'ìµëª… í™˜ì'}</PatientName>\r\n              <PatientId>ID: {patient.id}</PatientId>\r\n            </PatientNameContainer>\r\n          </div>\r\n        </PatientInfo>\r\n        \r\n        <TabNav>\r\n          <TabButton \r\n            active={activeTab === 'overview'} \r\n            onClick={() => setActiveTab('overview')}\r\n          >\r\n            ê¸°ë³¸ ì •ë³´\r\n          </TabButton>\r\n          <TabButton \r\n            active={activeTab === 'survey'} \r\n            onClick={() => setActiveTab('survey')}\r\n          >\r\n            ê±´ê°• ìƒíƒœ\r\n          </TabButton>\r\n          <TabButton \r\n            active={activeTab === 'counseling'} \r\n            onClick={() => setActiveTab('counseling')}\r\n          >\r\n            ìƒë‹´ ê¸°ë¡\r\n          </TabButton>\r\n        </TabNav>\r\n        \r\n        {activeTab === 'overview' && (\r\n          <>\r\n            <Card>\r\n              <CardTitle>í™˜ì ê¸°ë³¸ ì •ë³´</CardTitle>\r\n              <InfoGrid>\r\n                <InfoGroup>\r\n                  <InfoLabel>ì´ë¦„</InfoLabel>\r\n                  <InfoValue>{patient.name || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ì„±ë³„</InfoLabel>\r\n                  <InfoValue>{patient.gender || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ìƒë…„ì›”ì¼</InfoLabel>\r\n                  <InfoValue>{patient.birthDate || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ë‚˜ì´</InfoLabel>\r\n                  <InfoValue>{patient.age !== null ? `${patient.age}ì„¸` : 'ê³„ì‚° ë¶ˆê°€'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ê²°í˜¼ ìƒíƒœ</InfoLabel>\r\n                  <InfoValue>{patient.maritalStatus || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ì•” ì¢…ë¥˜</InfoLabel>\r\n                  <InfoValue>{patient.cancerType || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ì•” ë³‘ê¸°</InfoLabel>\r\n                  <InfoValue>{patient.cancerStage || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ì§„ë‹¨ì¼</InfoLabel>\r\n                  <InfoValue>{patient.diagnosisDate || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ì¬ë°œ ì—¬ë¶€</InfoLabel>\r\n                  <InfoValue>{patient.hasRecurrence || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ìˆ˜ìˆ  ì—¬ë¶€</InfoLabel>\r\n                  <InfoValue>{patient.hasSurgery || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                {patient.surgeryDate && (\r\n                  <InfoGroup>\r\n                    <InfoLabel>ìˆ˜ìˆ ì¼</InfoLabel>\r\n                    <InfoValue>{patient.surgeryDate}</InfoValue>\r\n                  </InfoGroup>\r\n                )}\r\n                <InfoGroup>\r\n                  <InfoLabel>ë‹¤ë¥¸ ì•” ì§„ë‹¨ ì—¬ë¶€</InfoLabel>\r\n                  <InfoValue>{patient.otherCancerDiagnosis || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                {patient.otherCancerType && (\r\n                  <InfoGroup>\r\n                    <InfoLabel>ë‹¤ë¥¸ ì•” ì¢…ë¥˜</InfoLabel>\r\n                    <InfoValue>{patient.otherCancerType}</InfoValue>\r\n                  </InfoGroup>\r\n                )}\r\n                {patient.otherCancerDetails && (\r\n                  <InfoGroup>\r\n                    <InfoLabel>ë‹¤ë¥¸ ì•” ìƒì„¸ ì •ë³´</InfoLabel>\r\n                    <InfoValue>{patient.otherCancerDetails}</InfoValue>\r\n                  </InfoGroup>\r\n                )}\r\n                <InfoGroup>\r\n                  <InfoLabel>ì •ì‹  ê±´ê°•ë ¥</InfoLabel>\r\n                  <InfoValue>{patient.mentalHealthHistory || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ì •ì‹ ê±´ê°• ì§„ë‹¨ëª…</InfoLabel>\r\n                  <InfoValue>{patient.mentalHealthDiagnoses || 'ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                {patient.otherMentalDiagnosis && (\r\n                  <InfoGroup>\r\n                    <InfoLabel>ê¸°íƒ€ ì •ì‹ ê±´ê°• ì§„ë‹¨</InfoLabel>\r\n                    <InfoValue>{patient.otherMentalDiagnosis}</InfoValue>\r\n                  </InfoGroup>\r\n                )}\r\n                {patient.mentalHealthImpact && (\r\n                  <InfoGroup>\r\n                    <InfoLabel>ì •ì‹ ê±´ê°• ì˜í–¥</InfoLabel>\r\n                    <InfoValue>{patient.mentalHealthImpact}</InfoValue>\r\n                  </InfoGroup>\r\n                )}\r\n                {patient.otherTreatmentType && (\r\n                  <InfoGroup>\r\n                    <InfoLabel>ê¸°íƒ€ ì¹˜ë£Œë²•</InfoLabel>\r\n                    <InfoValue>{patient.otherTreatmentType}</InfoValue>\r\n                  </InfoGroup>\r\n                )}\r\n                <InfoGroup>\r\n                  <InfoLabel>ì ˆì£¼ ì—¬ë¶€</InfoLabel>\r\n                  <InfoValue>{patient.alcoholAbstinence || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ê¸ˆì—° ì—¬ë¶€</InfoLabel>\r\n                  <InfoValue>{patient.smokingCessation || 'ì •ë³´ ì—†ìŒ'}</InfoValue>\r\n                </InfoGroup>\r\n                <InfoGroup>\r\n                  <InfoLabel>ìœ„í—˜ë„</InfoLabel>\r\n                  <Badge type={patient.riskLevel}>\r\n                    {patient.riskLevel === 'high' ? 'ìœ„í—˜' : \r\n                     patient.riskLevel === 'medium' ? 'ì£¼ì˜' : 'ì–‘í˜¸'}\r\n                  </Badge>\r\n                </InfoGroup>\r\n              </InfoGrid>\r\n            </Card>\r\n            \r\n            <Card>\r\n              <CardTitle>ìµœê·¼ ìƒë‹´ ìš”ì²­</CardTitle>\r\n              {counselingRequests.length === 0 ? (\r\n                <EmptyState>ì•„ì§ ìƒë‹´ ìš”ì²­ì´ ì—†ìŠµë‹ˆë‹¤.</EmptyState>\r\n              ) : (\r\n                <CounselingRequestsList>\r\n                  {counselingRequests.slice(0, 3).map(request => (\r\n                    <CounselingRequestItem key={request.id}>\r\n                      <CounselingRequestHeader>\r\n                        <CounselingRequestTitle>\r\n                          ìƒë‹´ ìš”ì²­ #{request.id.substring(0, 8)}\r\n                        </CounselingRequestTitle>\r\n                        <Badge status={request.status}>\r\n                          {getRequestStatusText(request.status)}\r\n                        </Badge>\r\n                      </CounselingRequestHeader>\r\n                      <p>{request.concerns}</p>\r\n                      <CounselingRequestMeta>\r\n                        <span>ìš”ì²­ì¼: {request.createdAt.toLocaleDateString()}</span>\r\n                        <Button onClick={() => handleProcessRequest(request.id)}>\r\n                          ìƒì„¸ë³´ê¸°\r\n                        </Button>\r\n                      </CounselingRequestMeta>\r\n                    </CounselingRequestItem>\r\n                  ))}\r\n                </CounselingRequestsList>\r\n              )}\r\n            </Card>\r\n          </>\r\n        )}\r\n        \r\n        {activeTab === 'survey' && (\r\n          <>\r\n            <Card>\r\n              <CardTitle>ê±´ê°• ìƒíƒœ í‰ê°€</CardTitle>\r\n              \r\n              <ScoreCardsContainer>\r\n                {Object.entries(categoryScores).map(([key, data]) => (\r\n                  <ScoreCard key={key}>\r\n                    <ScoreLabel>{data.title}</ScoreLabel>\r\n                    {data.score !== null ? (\r\n                      <ScoreValue score={data.score}>\r\n                        {data.score}\r\n                      </ScoreValue>\r\n                    ) : (\r\n                      <EmptyScore />\r\n                    )}\r\n                    <InfoLabel>{getScoreLevel(data.score)}</InfoLabel>\r\n                  </ScoreCard>\r\n                ))}\r\n              </ScoreCardsContainer>\r\n              \r\n              <TwoColumnGrid>\r\n                <Card>\r\n                  <CardTitle>ì˜ì—­ë³„ ë¹„êµ</CardTitle>\r\n                  <ChartContainer>\r\n                    <Radar data={radarChartData} options={radarChartOptions} />\r\n                  </ChartContainer>\r\n                </Card>\r\n                \r\n                <Card>\r\n                  <CardTitle>ì¹´í…Œê³ ë¦¬ë³„ ì ìˆ˜</CardTitle>\r\n                  <ChartContainer>\r\n                    <Bar data={barChartData} options={barChartOptions} />\r\n                  </ChartContainer>\r\n                </Card>\r\n              </TwoColumnGrid>\r\n            </Card>\r\n            \r\n            <Card>\r\n              <CardTitle>í™˜ì íŠ¹ì´ì‚¬í•­</CardTitle>\r\n              \r\n              {/* íŠ¹ì´ì‚¬í•­ ë‚´ìš©ì´ ì—†ì„ ê²½ìš° */}\r\n              {(!surveyData || \r\n                ((!surveyData.q12_reasons || Object.keys(surveyData.q12_reasons).length === 0) && \r\n                 (!surveyData.q13 || parseInt(surveyData.q13) < 3) && \r\n                 (!surveyData.q15_reasons || Object.keys(surveyData.q15_reasons).length === 0))\r\n              ) && (\r\n                <EmptyState>íŠ¹ì´ì‚¬í•­ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.</EmptyState>\r\n              )}\r\n              \r\n              {/* íŠ¹ì´ì‚¬í•­ ë‚´ìš©ì´ ìˆì„ ê²½ìš° */}\r\n              {surveyData && (\r\n                <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(300px, 1fr))', gap: '1.5rem' }}>\r\n                  \r\n                  {/* ê±´ê°•ê´€ë¦¬ ì¥ì• ìš”ì¸ */}\r\n                  {surveyData.q12_reasons && Object.keys(surveyData.q12_reasons).length > 0 && (\r\n                    <SpecialNoteContainer>\r\n                      <SpecialNoteTitle>\r\n                        ê±´ê°•ê´€ë¦¬ì— ì–´ë ¤ì›€ì´ ìˆëŠ” ì´ìœ \r\n                      </SpecialNoteTitle>\r\n                      <SpecialNoteList>\r\n                        {Object.entries(surveyData.q12_reasons).map(([index, reason]) => (\r\n                          <li key={index}>{reason}</li>\r\n                        ))}\r\n                      </SpecialNoteList>\r\n                    </SpecialNoteContainer>\r\n                  )}\r\n                  \r\n                  {/* ì‹ì´ì¡°ì ˆ ë°©ì‹ */}\r\n                  {surveyData.q13 && parseInt(surveyData.q13) >= 3 && (\r\n                    <SpecialNoteContainer>\r\n                      <SpecialNoteTitle>\r\n                        ì‹ì´ì¡°ì ˆ ë°©ì‹\r\n                      </SpecialNoteTitle>\r\n                      <SpecialNoteList>\r\n                        {[1, 2, 3, 4, 5, 6].map(subNum => {\r\n                          const subQuestionKey = `q13_1_${subNum}`;\r\n                          if (surveyData[subQuestionKey] && parseInt(surveyData[subQuestionKey]) >= 3) {\r\n                            return (\r\n                              <li key={subNum}>\r\n                                <div>{surveyQuestions[subQuestionKey]}</div>\r\n                                <ScoreBadge>\r\n                                  {getScoreDescription(surveyData[subQuestionKey])}\r\n                                </ScoreBadge>\r\n                              </li>\r\n                            );\r\n                          }\r\n                          return null;\r\n                        }).filter(Boolean)}\r\n                      </SpecialNoteList>\r\n                    </SpecialNoteContainer>\r\n                  )}\r\n                  \r\n                  {/* ê°€ì¡± ì§€ì§€ ë¶€ì¡± ì´ìœ  */}\r\n                  {surveyData.q15_reasons && Object.keys(surveyData.q15_reasons).length > 0 && (\r\n                    <SpecialNoteContainer>\r\n                      <SpecialNoteTitle>\r\n                        ê°€ì¡± ì§€ì§€ê°€ ë¶€ì¡±í•œ ì´ìœ \r\n                      </SpecialNoteTitle>\r\n                      <SpecialNoteList>\r\n                        {Object.entries(surveyData.q15_reasons).map(([index, reason]) => (\r\n                          <li key={index}>{reason}</li>\r\n                        ))}\r\n                      </SpecialNoteList>\r\n                    </SpecialNoteContainer>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </Card>\r\n          </>\r\n        )}\r\n        \r\n        {activeTab === 'counseling' && (\r\n          <>\r\n            {/* ì„¤ë¬¸ ê²°ê³¼ í”¼ë“œë°± ì„¹ì…˜ */}\r\n            <Card>\r\n              <CardTitle>í™˜ì ì„¤ë¬¸ ê²°ê³¼ í”¼ë“œë°±</CardTitle>\r\n              {(!patient || (!surveyData || (!surveyData.overallFeedback && !surveyData.additionalFeedback))) ? (\r\n                <NoFeedbackState>\r\n                  ì•„ì§ ì„¤ë¬¸ ê²°ê³¼ í”¼ë“œë°±ì´ ì—†ìŠµë‹ˆë‹¤.\r\n                  <br />\r\n                  í™˜ìê°€ ì„¤ë¬¸ì„ ì™„ë£Œí•˜ë©´ í”¼ë“œë°±ì´ í‘œì‹œë©ë‹ˆë‹¤.\r\n                </NoFeedbackState>\r\n              ) : (\r\n                <FeedbackContainer>\r\n                  <FeedbackTitle>ì œê³µëœ ê±´ê°• ê´€ë¦¬ ê°€ì´ë“œ</FeedbackTitle>\r\n                  \r\n                  {surveyData.overallFeedback && (\r\n                    <FeedbackSection>\r\n                      <FeedbackSectionTitle type=\"overall\">\r\n                        ì¢…í•© í‰ê°€ ë° ê¶Œì¥ì‚¬í•­\r\n                      </FeedbackSectionTitle>\r\n                      <FeedbackContent>\r\n                        {surveyData.overallFeedback}\r\n                      </FeedbackContent>\r\n                    </FeedbackSection>\r\n                  )}\r\n                  \r\n                  {surveyData.additionalFeedback && (\r\n                    <FeedbackSection>\r\n                      <FeedbackSectionTitle type=\"additional\">\r\n                        ì¶”ê°€ ì¡°ì–¸ ë° ì°¸ê³ ì‚¬í•­\r\n                      </FeedbackSectionTitle>\r\n                      <FeedbackContent>\r\n                        {surveyData.additionalFeedback}\r\n                      </FeedbackContent>\r\n                    </FeedbackSection>\r\n                  )}\r\n                </FeedbackContainer>\r\n              )}\r\n            </Card>\r\n            \r\n            <Card>\r\n              <CardTitle>ìƒë‹´ ë…¸íŠ¸ ì‘ì„±</CardTitle>\r\n              <NoteForm onSubmit={handleAddNote}>\r\n                <TextArea\r\n                  value={newNote}\r\n                  onChange={(e) => setNewNote(e.target.value)}\r\n                  placeholder=\"í™˜ìì™€ì˜ ìƒë‹´ ë‚´ìš©, ê´€ì°° ì‚¬í•­, í›„ì† ì¡°ì¹˜ ë“±ì„ ê¸°ë¡í•˜ì„¸ìš”...\"\r\n                />\r\n                <Button type=\"submit\">ë…¸íŠ¸ ì €ì¥</Button>\r\n              </NoteForm>\r\n            </Card>\r\n            \r\n            <Card>\r\n              <CardTitle>ìƒë‹´ ë…¸íŠ¸ ê¸°ë¡</CardTitle>\r\n              {notes.length === 0 ? (\r\n                <EmptyState>ì•„ì§ ìƒë‹´ ë…¸íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.</EmptyState>\r\n              ) : (\r\n                <NotesList>\r\n                  {notes.map(note => (\r\n                    <NoteItem key={note.id}>\r\n                      <NoteHeader>\r\n                        <NoteInfo>\r\n                          <NoteDate>{note.createdAt.toLocaleString()}</NoteDate>\r\n                        </NoteInfo>\r\n                        \r\n                        {editNoteId !== note.id && (\r\n                          <NoteActions>\r\n                            <NoteActionButton onClick={() => handleEditMode(note)}>\r\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                <path d=\"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z\"></path>\r\n                              </svg>\r\n                              ìˆ˜ì •\r\n                            </NoteActionButton>\r\n                            <NoteActionButton delete onClick={() => handleDeleteNote(note.id)}>\r\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                <polyline points=\"3 6 5 6 21 6\"></polyline>\r\n                                <path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2 2h4a2 2 0 0 1 2 2v2\"></path>\r\n                                <line x1=\"10\" y1=\"11\" x2=\"10\" y2=\"17\"></line>\r\n                                <line x1=\"14\" y1=\"11\" x2=\"14\" y2=\"17\"></line>\r\n                              </svg>\r\n                              ì‚­ì œ\r\n                            </NoteActionButton>\r\n                          </NoteActions>\r\n                        )}\r\n                      </NoteHeader>\r\n                      \r\n                      {editNoteId === note.id ? (\r\n                        <div>\r\n                          <NoteEditTextArea \r\n                            value={editNoteContent}\r\n                            onChange={(e) => setEditNoteContent(e.target.value)}\r\n                          />\r\n                          <EditButtonGroup>\r\n                            <Button secondary onClick={handleCancelEdit}>ì·¨ì†Œ</Button>\r\n                            <Button onClick={() => handleUpdateNote(note.id)}>ì €ì¥</Button>\r\n                          </EditButtonGroup>\r\n                        </div>\r\n                      ) : (\r\n                        <NoteContent>{note.content}</NoteContent>\r\n                      )}\r\n                    </NoteItem>\r\n                  ))}\r\n                </NotesList>\r\n              )}\r\n            </Card>\r\n          </>\r\n        )}\r\n      </Container>\r\n    </Layout>\r\n  );\r\n}\r\n\r\nexport default PatientDetailPage;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}